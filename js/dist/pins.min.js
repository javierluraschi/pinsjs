var pins=function(t){"use strict";var n={},e=function(t){return Object.keys(n).includes(t)?n[t]:function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return null}},r={get:e,set:function(t,e){n[t]=e}},o=function(t){return null==t},a=function(t,n){var r=e("getOption")(t);return o(r)?n:r},c=function(t,n){return null!==n&&(t=t.concat(n)),t},u=function(t){return Array.isArray(t)?t:[t]},s=function(t){if(Array.isArray(t)){if(1!=t.length)throw new Error("Array has more than one element but expecting only one");t=t[0]}return t},l=function(t){return Array.isArray(t)&&1==t.length?t[0]:t},f=function(t,n){e("uiViewerRegister")(t,n)},p=function(t){e("uiViewerUpdated")(t)},h={},d=function(){return Object.keys(h)},m=function(){return a("pins.path",r.get("userCacheDir")("pins"))},g=function(){return r.get("tempfile")()},v=function(t){return r.get("basename")(t)},y=function(t){return r.get("readLines")(t)},b=function(t,n){return r.get("writeLines")(t,n)},w=Object.freeze({create:function(t,n){void 0===n&&(n={recursive:!1});n.recursive;return r.get("dirCreate")(t)},exists:function(t){return r.get("dirExists")(t)},list:function(t){for(var n=[],e=arguments.length-1;e-- >0;)n[e]=arguments[e+1];return r.get("dirList")(s(t))},remove:function(t){for(var n=[],e=arguments.length-1;e-- >0;)n[e]=arguments[e+1];return(t=u(t)).map((function(n){return r.get("dirRemove")(t)}))},zip:function(t,n,e){for(var i=[],o=arguments.length-3;o-- >0;)i[o]=arguments[o+3];return r.get("dirZip")(t,t,e)}}),x=Object.freeze({filePathSansExt:function(t){return t.replace(/\.[^/.]+$/,"")},fileExt:function(t){return t.match(/\.[^/.]+$/,"")[0]}}),A=function(t,n){return r.get("fileWrite")(t,n)},k=function(t){return r.get("fileRead")(t)},O=function(t,n){return r.get("filePath")(t,n)},E=function(t,n){void 0===n&&(n={winslash:"\\",mustWork:!1});n.winslash,n.mustWork;return t},C=function(t){return t.replace(/[^\/]+$/,"")},j=function(t){return r.get("fileExists")(t)},P=function(t,n,e){void 0===e&&(e={recursive:!0});var i=e.recursive;return r.get("fileCopy")(t,n,i)},S=function(t){return r.get("fileSize")(t)},I=function(t,n){return r.get("md5")(t,n)},F=function(t,n){var e=[];return o(t)||(e=t),e.columns=n,e},T=function(t){if(Array.isArray(t)){if(0===t.length||void 0!==t.columns)return!0;if(1===t.length&&"object"==typeof t[0])return!0;if(t.length>1){for(var n=!0,e=1;e<t.length;e++)if("object"!=typeof t[e]||t[e].length!==t[0].length){n=!1;break}return n}}return!1},_=function(){return a("pins.board","local")},N=function(t){var n=t.cache,e=O(n,t.name);return w.exists(e)||w.create(e,{recursive:!0}),E(e,{mustWork:!1})},L=function(t){return!!t.then},R=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return new Promise((function(n,e){var r,i,o;r=null,i=null;var a=function(){try{var a;function c(){return o++,u}function u(){if(o<t.length-2){return L(t[o])?t[o]().then(function(t){try{return n.call(this)}catch(t){return e(t)}}.bind(this),e):(t[o](),n.call(this));function n(){return c}}return[1]}return o=0,(a=function(t){for(;t;){if(t.then)return void t.then(a,e);try{if(t.pop){if(t.length)return t.pop()?s.call(this):t;t=c}else t=t.call(this)}catch(t){return e(t)}}}.bind(this))(u);function s(){return r?e(r):n(i)}}catch(t){return e(t)}},c=function(t){try{return r=t,a()}catch(t){return e(t)}};try{return new Promise((function(n,e){return L(t[t.length-1])?t[t.length-1]().then(n,e):n(t[t.length-1]())})).then((function(t){try{return i=t,a()}catch(t){return c(t)}}),c)}catch(t){c(t)}}))},D=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];a("pins.verbose",!0)&&r.get("pinLog")(t.join(""))},M=function(t,n){a("pins.verbose",!0)&&r.get("pinLog")("Calling "+t+"("+JSON.stringify(n)+")")};function z(t){return null==t}var U={isNothing:z,isObject:function(t){return"object"==typeof t&&null!==t},toArray:function(t){return Array.isArray(t)?t:z(t)?[]:[t]},repeat:function(t,n){var e,r="";for(e=0;e<n;e+=1)r+=t;return r},isNegativeZero:function(t){return 0===t&&Number.NEGATIVE_INFINITY===1/t},extend:function(t,n){var e,r,i,o;if(n)for(e=0,r=(o=Object.keys(n)).length;e<r;e+=1)t[i=o[e]]=n[i];return t}};function G(t,n){Error.call(this),this.name="YAMLException",this.reason=t,this.mark=n,this.message=(this.reason||"(unknown reason)")+(this.mark?" "+this.mark.toString():""),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}G.prototype=Object.create(Error.prototype),G.prototype.constructor=G,G.prototype.toString=function(t){var n=this.name+": ";return n+=this.reason||"(unknown reason)",!t&&this.mark&&(n+=" "+this.mark.toString()),n};var q=G;function $(t,n,e,r,i){this.name=t,this.buffer=n,this.position=e,this.line=r,this.column=i}$.prototype.getSnippet=function(t,n){var e,r,i,o,a;if(!this.buffer)return null;for(t=t||4,n=n||75,e="",r=this.position;r>0&&-1==="\0\r\n\u2028\u2029".indexOf(this.buffer.charAt(r-1));)if(r-=1,this.position-r>n/2-1){e=" ... ",r+=5;break}for(i="",o=this.position;o<this.buffer.length&&-1==="\0\r\n\u2028\u2029".indexOf(this.buffer.charAt(o));)if((o+=1)-this.position>n/2-1){i=" ... ",o-=5;break}return a=this.buffer.slice(r,o),U.repeat(" ",t)+e+a+i+"\n"+U.repeat(" ",t+this.position-r+e.length)+"^"},$.prototype.toString=function(t){var n,e="";return this.name&&(e+='in "'+this.name+'" '),e+="at line "+(this.line+1)+", column "+(this.column+1),t||(n=this.getSnippet())&&(e+=":\n"+n),e};var W=$,Y=["kind","resolve","construct","instanceOf","predicate","represent","defaultStyle","styleAliases"],B=["scalar","sequence","mapping"];var V=function(t,n){if(n=n||{},Object.keys(n).forEach((function(n){if(-1===Y.indexOf(n))throw new q('Unknown option "'+n+'" is met in definition of "'+t+'" YAML type.')})),this.tag=t,this.kind=n.kind||null,this.resolve=n.resolve||function(){return!0},this.construct=n.construct||function(t){return t},this.instanceOf=n.instanceOf||null,this.predicate=n.predicate||null,this.represent=n.represent||null,this.defaultStyle=n.defaultStyle||null,this.styleAliases=function(t){var n={};return null!==t&&Object.keys(t).forEach((function(e){t[e].forEach((function(t){n[String(t)]=e}))})),n}(n.styleAliases||null),-1===B.indexOf(this.kind))throw new q('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')};function H(t,n,e){var r=[];return t.include.forEach((function(t){e=H(t,n,e)})),t[n].forEach((function(t){e.forEach((function(n,e){n.tag===t.tag&&n.kind===t.kind&&r.push(e)})),e.push(t)})),e.filter((function(t,n){return-1===r.indexOf(n)}))}function K(t){this.include=t.include||[],this.implicit=t.implicit||[],this.explicit=t.explicit||[],this.implicit.forEach((function(t){if(t.loadKind&&"scalar"!==t.loadKind)throw new q("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.")})),this.compiledImplicit=H(this,"implicit",[]),this.compiledExplicit=H(this,"explicit",[]),this.compiledTypeMap=function(){var t,n,e=arguments,r={scalar:{},sequence:{},mapping:{},fallback:{}};function i(t){r[t.kind][t.tag]=r.fallback[t.tag]=t}for(t=0,n=arguments.length;t<n;t+=1)e[t].forEach(i);return r}(this.compiledImplicit,this.compiledExplicit)}K.DEFAULT=null,K.create=function(){var t,n;switch(arguments.length){case 1:t=K.DEFAULT,n=arguments[0];break;case 2:t=arguments[0],n=arguments[1];break;default:throw new q("Wrong number of arguments for Schema.create function")}if(t=U.toArray(t),n=U.toArray(n),!t.every((function(t){return t instanceof K})))throw new q("Specified list of super schemas (or a single Schema object) contains a non-Schema object.");if(!n.every((function(t){return t instanceof V})))throw new q("Specified list of YAML types (or a single Type object) contains a non-Type object.");return new K({include:t,explicit:n})};var Z=K,J=new Z({explicit:[new V("tag:yaml.org,2002:str",{kind:"scalar",construct:function(t){return null!==t?t:""}}),new V("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(t){return null!==t?t:[]}}),new V("tag:yaml.org,2002:map",{kind:"mapping",construct:function(t){return null!==t?t:{}}})]});var Q=new V("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(t){if(null===t)return!0;var n=t.length;return 1===n&&"~"===t||4===n&&("null"===t||"Null"===t||"NULL"===t)},construct:function(){return null},predicate:function(t){return null===t},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"}},defaultStyle:"lowercase"});var X=new V("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(t){if(null===t)return!1;var n=t.length;return 4===n&&("true"===t||"True"===t||"TRUE"===t)||5===n&&("false"===t||"False"===t||"FALSE"===t)},construct:function(t){return"true"===t||"True"===t||"TRUE"===t},predicate:function(t){return"[object Boolean]"===Object.prototype.toString.call(t)},represent:{lowercase:function(t){return t?"true":"false"},uppercase:function(t){return t?"TRUE":"FALSE"},camelcase:function(t){return t?"True":"False"}},defaultStyle:"lowercase"});function tt(t){return 48<=t&&t<=55}function nt(t){return 48<=t&&t<=57}var et=new V("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(t){if(null===t)return!1;var n,e,r=t.length,i=0,o=!1;if(!r)return!1;if("-"!==(n=t[i])&&"+"!==n||(n=t[++i]),"0"===n){if(i+1===r)return!0;if("b"===(n=t[++i])){for(i++;i<r;i++)if("_"!==(n=t[i])){if("0"!==n&&"1"!==n)return!1;o=!0}return o&&"_"!==n}if("x"===n){for(i++;i<r;i++)if("_"!==(n=t[i])){if(!(48<=(e=t.charCodeAt(i))&&e<=57||65<=e&&e<=70||97<=e&&e<=102))return!1;o=!0}return o&&"_"!==n}for(;i<r;i++)if("_"!==(n=t[i])){if(!tt(t.charCodeAt(i)))return!1;o=!0}return o&&"_"!==n}if("_"===n)return!1;for(;i<r;i++)if("_"!==(n=t[i])){if(":"===n)break;if(!nt(t.charCodeAt(i)))return!1;o=!0}return!(!o||"_"===n)&&(":"!==n||/^(:[0-5]?[0-9])+$/.test(t.slice(i)))},construct:function(t){var n,e,r=t,i=1,o=[];return-1!==r.indexOf("_")&&(r=r.replace(/_/g,"")),"-"!==(n=r[0])&&"+"!==n||("-"===n&&(i=-1),n=(r=r.slice(1))[0]),"0"===r?0:"0"===n?"b"===r[1]?i*parseInt(r.slice(2),2):"x"===r[1]?i*parseInt(r,16):i*parseInt(r,8):-1!==r.indexOf(":")?(r.split(":").forEach((function(t){o.unshift(parseInt(t,10))})),r=0,e=1,o.forEach((function(t){r+=t*e,e*=60})),i*r):i*parseInt(r,10)},predicate:function(t){return"[object Number]"===Object.prototype.toString.call(t)&&t%1==0&&!U.isNegativeZero(t)},represent:{binary:function(t){return t>=0?"0b"+t.toString(2):"-0b"+t.toString(2).slice(1)},octal:function(t){return t>=0?"0"+t.toString(8):"-0"+t.toString(8).slice(1)},decimal:function(t){return t.toString(10)},hexadecimal:function(t){return t>=0?"0x"+t.toString(16).toUpperCase():"-0x"+t.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),rt=new RegExp("^(?:[-+]?(?:0|[1-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\\.[0-9_]*|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");var it=/^[-+]?[0-9]+e/;var ot=new Z({include:[J],implicit:[Q,X,et,new V("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(t){return null!==t&&!(!rt.test(t)||"_"===t[t.length-1])},construct:function(t){var n,e,r,i;return e="-"===(n=t.replace(/_/g,"").toLowerCase())[0]?-1:1,i=[],"+-".indexOf(n[0])>=0&&(n=n.slice(1)),".inf"===n?1===e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===n?NaN:n.indexOf(":")>=0?(n.split(":").forEach((function(t){i.unshift(parseFloat(t,10))})),n=0,r=1,i.forEach((function(t){n+=t*r,r*=60})),e*n):e*parseFloat(n,10)},predicate:function(t){return"[object Number]"===Object.prototype.toString.call(t)&&(t%1!=0||U.isNegativeZero(t))},represent:function(t,n){var e;if(isNaN(t))switch(n){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===t)switch(n){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===t)switch(n){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(U.isNegativeZero(t))return"-0.0";return e=t.toString(10),it.test(e)?e.replace("e",".e"):e},defaultStyle:"lowercase"})]}),at=new Z({include:[ot]}),ct=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),ut=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");var st=new V("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(t){return null!==t&&(null!==ct.exec(t)||null!==ut.exec(t))},construct:function(t){var n,e,r,i,o,a,c,u,s=0,l=null;if(null===(n=ct.exec(t))&&(n=ut.exec(t)),null===n)throw new Error("Date resolve error");if(e=+n[1],r=+n[2]-1,i=+n[3],!n[4])return new Date(Date.UTC(e,r,i));if(o=+n[4],a=+n[5],c=+n[6],n[7]){for(s=n[7].slice(0,3);s.length<3;)s+="0";s=+s}return n[9]&&(l=6e4*(60*+n[10]+ +(n[11]||0)),"-"===n[9]&&(l=-l)),u=new Date(Date.UTC(e,r,i,o,a,c,s)),l&&u.setTime(u.getTime()-l),u},instanceOf:Date,represent:function(t){return t.toISOString()}});var lt,ft=new V("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(t){return"<<"===t||null===t}});function pt(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}try{lt=pt("buffer").Buffer}catch(t){}var ht="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r";var dt=new V("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(t){if(null===t)return!1;var n,e,r=0,i=t.length,o=ht;for(e=0;e<i;e++)if(!((n=o.indexOf(t.charAt(e)))>64)){if(n<0)return!1;r+=6}return r%8==0},construct:function(t){var n,e,r=t.replace(/[\r\n=]/g,""),i=r.length,o=ht,a=0,c=[];for(n=0;n<i;n++)n%4==0&&n&&(c.push(a>>16&255),c.push(a>>8&255),c.push(255&a)),a=a<<6|o.indexOf(r.charAt(n));return 0===(e=i%4*6)?(c.push(a>>16&255),c.push(a>>8&255),c.push(255&a)):18===e?(c.push(a>>10&255),c.push(a>>2&255)):12===e&&c.push(a>>4&255),lt?lt.from?lt.from(c):new lt(c):c},predicate:function(t){return lt&&lt.isBuffer(t)},represent:function(t){var n,e,r="",i=0,o=t.length,a=ht;for(n=0;n<o;n++)n%3==0&&n&&(r+=a[i>>18&63],r+=a[i>>12&63],r+=a[i>>6&63],r+=a[63&i]),i=(i<<8)+t[n];return 0===(e=o%3)?(r+=a[i>>18&63],r+=a[i>>12&63],r+=a[i>>6&63],r+=a[63&i]):2===e?(r+=a[i>>10&63],r+=a[i>>4&63],r+=a[i<<2&63],r+=a[64]):1===e&&(r+=a[i>>2&63],r+=a[i<<4&63],r+=a[64],r+=a[64]),r}}),mt=Object.prototype.hasOwnProperty,gt=Object.prototype.toString;var vt=new V("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(t){if(null===t)return!0;var n,e,r,i,o,a=[],c=t;for(n=0,e=c.length;n<e;n+=1){if(r=c[n],o=!1,"[object Object]"!==gt.call(r))return!1;for(i in r)if(mt.call(r,i)){if(o)return!1;o=!0}if(!o)return!1;if(-1!==a.indexOf(i))return!1;a.push(i)}return!0},construct:function(t){return null!==t?t:[]}}),yt=Object.prototype.toString;var bt=new V("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(t){if(null===t)return!0;var n,e,r,i,o,a=t;for(o=new Array(a.length),n=0,e=a.length;n<e;n+=1){if(r=a[n],"[object Object]"!==yt.call(r))return!1;if(1!==(i=Object.keys(r)).length)return!1;o[n]=[i[0],r[i[0]]]}return!0},construct:function(t){if(null===t)return[];var n,e,r,i,o,a=t;for(o=new Array(a.length),n=0,e=a.length;n<e;n+=1)r=a[n],i=Object.keys(r),o[n]=[i[0],r[i[0]]];return o}}),wt=Object.prototype.hasOwnProperty;var xt=new Z({include:[at],implicit:[st,ft],explicit:[dt,vt,bt,new V("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(t){if(null===t)return!0;var n,e=t;for(n in e)if(wt.call(e,n)&&null!==e[n])return!1;return!0},construct:function(t){return null!==t?t:{}}})]});var At=new V("tag:yaml.org,2002:js/undefined",{kind:"scalar",resolve:function(){return!0},construct:function(){},predicate:function(t){return void 0===t},represent:function(){return""}});var kt,Ot=new V("tag:yaml.org,2002:js/regexp",{kind:"scalar",resolve:function(t){if(null===t)return!1;if(0===t.length)return!1;var n=t,e=/\/([gim]*)$/.exec(t),r="";if("/"===n[0]){if(e&&(r=e[1]),r.length>3)return!1;if("/"!==n[n.length-r.length-1])return!1}return!0},construct:function(t){var n=t,e=/\/([gim]*)$/.exec(t),r="";return"/"===n[0]&&(e&&(r=e[1]),n=n.slice(1,n.length-r.length-1)),new RegExp(n,r)},predicate:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},represent:function(t){var n="/"+t.source+"/";return t.global&&(n+="g"),t.multiline&&(n+="m"),t.ignoreCase&&(n+="i"),n}});try{kt=pt("esprima")}catch(t){"undefined"!=typeof window&&(kt=window.esprima)}var Et=new V("tag:yaml.org,2002:js/function",{kind:"scalar",resolve:function(t){if(null===t)return!1;try{var n="("+t+")",e=kt.parse(n,{range:!0});return"Program"===e.type&&1===e.body.length&&"ExpressionStatement"===e.body[0].type&&("ArrowFunctionExpression"===e.body[0].expression.type||"FunctionExpression"===e.body[0].expression.type)}catch(t){return!1}},construct:function(t){var n,e="("+t+")",r=kt.parse(e,{range:!0}),i=[];if("Program"!==r.type||1!==r.body.length||"ExpressionStatement"!==r.body[0].type||"ArrowFunctionExpression"!==r.body[0].expression.type&&"FunctionExpression"!==r.body[0].expression.type)throw new Error("Failed to resolve function");return r.body[0].expression.params.forEach((function(t){i.push(t.name)})),n=r.body[0].expression.body.range,"BlockStatement"===r.body[0].expression.body.type?new Function(i,e.slice(n[0]+1,n[1]-1)):new Function(i,"return "+e.slice(n[0],n[1]))},predicate:function(t){return"[object Function]"===Object.prototype.toString.call(t)},represent:function(t){return t.toString()}}),Ct=Z.DEFAULT=new Z({include:[xt],explicit:[At,Ot,Et]}),jt=Object.prototype.hasOwnProperty,Pt=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,St=/[\x85\u2028\u2029]/,It=/[,\[\]\{\}]/,Ft=/^(?:!|!!|![a-z\-]+!)$/i,Tt=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function _t(t){return Object.prototype.toString.call(t)}function Nt(t){return 10===t||13===t}function Lt(t){return 9===t||32===t}function Rt(t){return 9===t||32===t||10===t||13===t}function Dt(t){return 44===t||91===t||93===t||123===t||125===t}function Mt(t){var n;return 48<=t&&t<=57?t-48:97<=(n=32|t)&&n<=102?n-97+10:-1}function zt(t){return 48===t?"\0":97===t?"":98===t?"\b":116===t||9===t?"\t":110===t?"\n":118===t?"\v":102===t?"\f":114===t?"\r":101===t?"":32===t?" ":34===t?'"':47===t?"/":92===t?"\\":78===t?"":95===t?" ":76===t?"\u2028":80===t?"\u2029":""}function Ut(t){return t<=65535?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10),56320+(t-65536&1023))}for(var Gt=new Array(256),qt=new Array(256),$t=0;$t<256;$t++)Gt[$t]=zt($t)?1:0,qt[$t]=zt($t);function Wt(t,n){this.input=t,this.filename=n.filename||null,this.schema=n.schema||Ct,this.onWarning=n.onWarning||null,this.legacy=n.legacy||!1,this.json=n.json||!1,this.listener=n.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=t.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.documents=[]}function Yt(t,n){return new q(n,new W(t.filename,t.input,t.position,t.line,t.position-t.lineStart))}function Bt(t,n){throw Yt(t,n)}function Vt(t,n){t.onWarning&&t.onWarning.call(null,Yt(t,n))}var Ht={YAML:function(t,n,e){var r,i,o;null!==t.version&&Bt(t,"duplication of %YAML directive"),1!==e.length&&Bt(t,"YAML directive accepts exactly one argument"),null===(r=/^([0-9]+)\.([0-9]+)$/.exec(e[0]))&&Bt(t,"ill-formed argument of the YAML directive"),i=parseInt(r[1],10),o=parseInt(r[2],10),1!==i&&Bt(t,"unacceptable YAML version of the document"),t.version=e[0],t.checkLineBreaks=o<2,1!==o&&2!==o&&Vt(t,"unsupported YAML version of the document")},TAG:function(t,n,e){var r,i;2!==e.length&&Bt(t,"TAG directive accepts exactly two arguments"),r=e[0],i=e[1],Ft.test(r)||Bt(t,"ill-formed tag handle (first argument) of the TAG directive"),jt.call(t.tagMap,r)&&Bt(t,'there is a previously declared suffix for "'+r+'" tag handle'),Tt.test(i)||Bt(t,"ill-formed tag prefix (second argument) of the TAG directive"),t.tagMap[r]=i}};function Kt(t,n,e,r){var i,o,a,c;if(n<e){if(c=t.input.slice(n,e),r)for(i=0,o=c.length;i<o;i+=1)9===(a=c.charCodeAt(i))||32<=a&&a<=1114111||Bt(t,"expected valid JSON character");else Pt.test(c)&&Bt(t,"the stream contains non-printable characters");t.result+=c}}function Zt(t,n,e,r){var i,o,a,c;for(U.isObject(e)||Bt(t,"cannot merge mappings; the provided source object is unacceptable"),a=0,c=(i=Object.keys(e)).length;a<c;a+=1)o=i[a],jt.call(n,o)||(n[o]=e[o],r[o]=!0)}function Jt(t,n,e,r,i,o,a,c){var u,s;if(Array.isArray(i))for(u=0,s=(i=Array.prototype.slice.call(i)).length;u<s;u+=1)Array.isArray(i[u])&&Bt(t,"nested arrays are not supported inside keys"),"object"==typeof i&&"[object Object]"===_t(i[u])&&(i[u]="[object Object]");if("object"==typeof i&&"[object Object]"===_t(i)&&(i="[object Object]"),i=String(i),null===n&&(n={}),"tag:yaml.org,2002:merge"===r)if(Array.isArray(o))for(u=0,s=o.length;u<s;u+=1)Zt(t,n,o[u],e);else Zt(t,n,o,e);else t.json||jt.call(e,i)||!jt.call(n,i)||(t.line=a||t.line,t.position=c||t.position,Bt(t,"duplicated mapping key")),n[i]=o,delete e[i];return n}function Qt(t){var n;10===(n=t.input.charCodeAt(t.position))?t.position++:13===n?(t.position++,10===t.input.charCodeAt(t.position)&&t.position++):Bt(t,"a line break is expected"),t.line+=1,t.lineStart=t.position}function Xt(t,n,e){for(var r=0,i=t.input.charCodeAt(t.position);0!==i;){for(;Lt(i);)i=t.input.charCodeAt(++t.position);if(n&&35===i)do{i=t.input.charCodeAt(++t.position)}while(10!==i&&13!==i&&0!==i);if(!Nt(i))break;for(Qt(t),i=t.input.charCodeAt(t.position),r++,t.lineIndent=0;32===i;)t.lineIndent++,i=t.input.charCodeAt(++t.position)}return-1!==e&&0!==r&&t.lineIndent<e&&Vt(t,"deficient indentation"),r}function tn(t){var n,e=t.position;return!(45!==(n=t.input.charCodeAt(e))&&46!==n||n!==t.input.charCodeAt(e+1)||n!==t.input.charCodeAt(e+2)||(e+=3,0!==(n=t.input.charCodeAt(e))&&!Rt(n)))}function nn(t,n){1===n?t.result+=" ":n>1&&(t.result+=U.repeat("\n",n-1))}function en(t,n){var e,r,i=t.tag,o=t.anchor,a=[],c=!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=a),r=t.input.charCodeAt(t.position);0!==r&&45===r&&Rt(t.input.charCodeAt(t.position+1));)if(c=!0,t.position++,Xt(t,!0,-1)&&t.lineIndent<=n)a.push(null),r=t.input.charCodeAt(t.position);else if(e=t.line,an(t,n,3,!1,!0),a.push(t.result),Xt(t,!0,-1),r=t.input.charCodeAt(t.position),(t.line===e||t.lineIndent>n)&&0!==r)Bt(t,"bad indentation of a sequence entry");else if(t.lineIndent<n)break;return!!c&&(t.tag=i,t.anchor=o,t.kind="sequence",t.result=a,!0)}function rn(t){var n,e,r,i,o=!1,a=!1;if(33!==(i=t.input.charCodeAt(t.position)))return!1;if(null!==t.tag&&Bt(t,"duplication of a tag property"),60===(i=t.input.charCodeAt(++t.position))?(o=!0,i=t.input.charCodeAt(++t.position)):33===i?(a=!0,e="!!",i=t.input.charCodeAt(++t.position)):e="!",n=t.position,o){do{i=t.input.charCodeAt(++t.position)}while(0!==i&&62!==i);t.position<t.length?(r=t.input.slice(n,t.position),i=t.input.charCodeAt(++t.position)):Bt(t,"unexpected end of the stream within a verbatim tag")}else{for(;0!==i&&!Rt(i);)33===i&&(a?Bt(t,"tag suffix cannot contain exclamation marks"):(e=t.input.slice(n-1,t.position+1),Ft.test(e)||Bt(t,"named tag handle cannot contain such characters"),a=!0,n=t.position+1)),i=t.input.charCodeAt(++t.position);r=t.input.slice(n,t.position),It.test(r)&&Bt(t,"tag suffix cannot contain flow indicator characters")}return r&&!Tt.test(r)&&Bt(t,"tag name cannot contain such characters: "+r),o?t.tag=r:jt.call(t.tagMap,e)?t.tag=t.tagMap[e]+r:"!"===e?t.tag="!"+r:"!!"===e?t.tag="tag:yaml.org,2002:"+r:Bt(t,'undeclared tag handle "'+e+'"'),!0}function on(t){var n,e;if(38!==(e=t.input.charCodeAt(t.position)))return!1;for(null!==t.anchor&&Bt(t,"duplication of an anchor property"),e=t.input.charCodeAt(++t.position),n=t.position;0!==e&&!Rt(e)&&!Dt(e);)e=t.input.charCodeAt(++t.position);return t.position===n&&Bt(t,"name of an anchor node must contain at least one character"),t.anchor=t.input.slice(n,t.position),!0}function an(t,n,e,r,i){var o,a,c,u,s,l,f,p,h=1,d=!1,m=!1;if(null!==t.listener&&t.listener("open",t),t.tag=null,t.anchor=null,t.kind=null,t.result=null,o=a=c=4===e||3===e,r&&Xt(t,!0,-1)&&(d=!0,t.lineIndent>n?h=1:t.lineIndent===n?h=0:t.lineIndent<n&&(h=-1)),1===h)for(;rn(t)||on(t);)Xt(t,!0,-1)?(d=!0,c=o,t.lineIndent>n?h=1:t.lineIndent===n?h=0:t.lineIndent<n&&(h=-1)):c=!1;if(c&&(c=d||i),1!==h&&4!==e||(f=1===e||2===e?n:n+1,p=t.position-t.lineStart,1===h?c&&(en(t,p)||function(t,n,e){var r,i,o,a,c,u=t.tag,s=t.anchor,l={},f={},p=null,h=null,d=null,m=!1,g=!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=l),c=t.input.charCodeAt(t.position);0!==c;){if(r=t.input.charCodeAt(t.position+1),o=t.line,a=t.position,63!==c&&58!==c||!Rt(r)){if(!an(t,e,2,!1,!0))break;if(t.line===o){for(c=t.input.charCodeAt(t.position);Lt(c);)c=t.input.charCodeAt(++t.position);if(58===c)Rt(c=t.input.charCodeAt(++t.position))||Bt(t,"a whitespace character is expected after the key-value separator within a block mapping"),m&&(Jt(t,l,f,p,h,null),p=h=d=null),g=!0,m=!1,i=!1,p=t.tag,h=t.result;else{if(!g)return t.tag=u,t.anchor=s,!0;Bt(t,"can not read an implicit mapping pair; a colon is missed")}}else{if(!g)return t.tag=u,t.anchor=s,!0;Bt(t,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===c?(m&&(Jt(t,l,f,p,h,null),p=h=d=null),g=!0,m=!0,i=!0):m?(m=!1,i=!0):Bt(t,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),t.position+=1,c=r;if((t.line===o||t.lineIndent>n)&&(an(t,n,4,!0,i)&&(m?h=t.result:d=t.result),m||(Jt(t,l,f,p,h,d,o,a),p=h=d=null),Xt(t,!0,-1),c=t.input.charCodeAt(t.position)),t.lineIndent>n&&0!==c)Bt(t,"bad indentation of a mapping entry");else if(t.lineIndent<n)break}return m&&Jt(t,l,f,p,h,null),g&&(t.tag=u,t.anchor=s,t.kind="mapping",t.result=l),g}(t,p,f))||function(t,n){var e,r,i,o,a,c,u,s,l,f,p=!0,h=t.tag,d=t.anchor,m={};if(91===(f=t.input.charCodeAt(t.position)))i=93,c=!1,r=[];else{if(123!==f)return!1;i=125,c=!0,r={}}for(null!==t.anchor&&(t.anchorMap[t.anchor]=r),f=t.input.charCodeAt(++t.position);0!==f;){if(Xt(t,!0,n),(f=t.input.charCodeAt(t.position))===i)return t.position++,t.tag=h,t.anchor=d,t.kind=c?"mapping":"sequence",t.result=r,!0;p||Bt(t,"missed comma between flow collection entries"),l=null,o=a=!1,63===f&&Rt(t.input.charCodeAt(t.position+1))&&(o=a=!0,t.position++,Xt(t,!0,n)),e=t.line,an(t,n,1,!1,!0),s=t.tag,u=t.result,Xt(t,!0,n),f=t.input.charCodeAt(t.position),!a&&t.line!==e||58!==f||(o=!0,f=t.input.charCodeAt(++t.position),Xt(t,!0,n),an(t,n,1,!1,!0),l=t.result),c?Jt(t,r,m,s,u,l):o?r.push(Jt(t,null,m,s,u,l)):r.push(u),Xt(t,!0,n),44===(f=t.input.charCodeAt(t.position))?(p=!0,f=t.input.charCodeAt(++t.position)):p=!1}Bt(t,"unexpected end of the stream within a flow collection")}(t,f)?m=!0:(a&&function(t,n){var e,r,i,o,a,c=1,u=!1,s=!1,l=n,f=0,p=!1;if(124===(o=t.input.charCodeAt(t.position)))r=!1;else{if(62!==o)return!1;r=!0}for(t.kind="scalar",t.result="";0!==o;)if(43===(o=t.input.charCodeAt(++t.position))||45===o)1===c?c=43===o?3:2:Bt(t,"repeat of a chomping mode identifier");else{if(!((i=48<=(a=o)&&a<=57?a-48:-1)>=0))break;0===i?Bt(t,"bad explicit indentation width of a block scalar; it cannot be less than one"):s?Bt(t,"repeat of an indentation width identifier"):(l=n+i-1,s=!0)}if(Lt(o)){do{o=t.input.charCodeAt(++t.position)}while(Lt(o));if(35===o)do{o=t.input.charCodeAt(++t.position)}while(!Nt(o)&&0!==o)}for(;0!==o;){for(Qt(t),t.lineIndent=0,o=t.input.charCodeAt(t.position);(!s||t.lineIndent<l)&&32===o;)t.lineIndent++,o=t.input.charCodeAt(++t.position);if(!s&&t.lineIndent>l&&(l=t.lineIndent),Nt(o))f++;else{if(t.lineIndent<l){3===c?t.result+=U.repeat("\n",u?1+f:f):1===c&&u&&(t.result+="\n");break}for(r?Lt(o)?(p=!0,t.result+=U.repeat("\n",u?1+f:f)):p?(p=!1,t.result+=U.repeat("\n",f+1)):0===f?u&&(t.result+=" "):t.result+=U.repeat("\n",f):t.result+=U.repeat("\n",u?1+f:f),u=!0,s=!0,f=0,e=t.position;!Nt(o)&&0!==o;)o=t.input.charCodeAt(++t.position);Kt(t,e,t.position,!1)}}return!0}(t,f)||function(t,n){var e,r,i;if(39!==(e=t.input.charCodeAt(t.position)))return!1;for(t.kind="scalar",t.result="",t.position++,r=i=t.position;0!==(e=t.input.charCodeAt(t.position));)if(39===e){if(Kt(t,r,t.position,!0),39!==(e=t.input.charCodeAt(++t.position)))return!0;r=t.position,t.position++,i=t.position}else Nt(e)?(Kt(t,r,i,!0),nn(t,Xt(t,!1,n)),r=i=t.position):t.position===t.lineStart&&tn(t)?Bt(t,"unexpected end of the document within a single quoted scalar"):(t.position++,i=t.position);Bt(t,"unexpected end of the stream within a single quoted scalar")}(t,f)||function(t,n){var e,r,i,o,a,c,u;if(34!==(c=t.input.charCodeAt(t.position)))return!1;for(t.kind="scalar",t.result="",t.position++,e=r=t.position;0!==(c=t.input.charCodeAt(t.position));){if(34===c)return Kt(t,e,t.position,!0),t.position++,!0;if(92===c){if(Kt(t,e,t.position,!0),Nt(c=t.input.charCodeAt(++t.position)))Xt(t,!1,n);else if(c<256&&Gt[c])t.result+=qt[c],t.position++;else if((a=120===(u=c)?2:117===u?4:85===u?8:0)>0){for(i=a,o=0;i>0;i--)(a=Mt(c=t.input.charCodeAt(++t.position)))>=0?o=(o<<4)+a:Bt(t,"expected hexadecimal character");t.result+=Ut(o),t.position++}else Bt(t,"unknown escape sequence");e=r=t.position}else Nt(c)?(Kt(t,e,r,!0),nn(t,Xt(t,!1,n)),e=r=t.position):t.position===t.lineStart&&tn(t)?Bt(t,"unexpected end of the document within a double quoted scalar"):(t.position++,r=t.position)}Bt(t,"unexpected end of the stream within a double quoted scalar")}(t,f)?m=!0:!function(t){var n,e,r;if(42!==(r=t.input.charCodeAt(t.position)))return!1;for(r=t.input.charCodeAt(++t.position),n=t.position;0!==r&&!Rt(r)&&!Dt(r);)r=t.input.charCodeAt(++t.position);return t.position===n&&Bt(t,"name of an alias node must contain at least one character"),e=t.input.slice(n,t.position),t.anchorMap.hasOwnProperty(e)||Bt(t,'unidentified alias "'+e+'"'),t.result=t.anchorMap[e],Xt(t,!0,-1),!0}(t)?function(t,n,e){var r,i,o,a,c,u,s,l,f=t.kind,p=t.result;if(Rt(l=t.input.charCodeAt(t.position))||Dt(l)||35===l||38===l||42===l||33===l||124===l||62===l||39===l||34===l||37===l||64===l||96===l)return!1;if((63===l||45===l)&&(Rt(r=t.input.charCodeAt(t.position+1))||e&&Dt(r)))return!1;for(t.kind="scalar",t.result="",i=o=t.position,a=!1;0!==l;){if(58===l){if(Rt(r=t.input.charCodeAt(t.position+1))||e&&Dt(r))break}else if(35===l){if(Rt(t.input.charCodeAt(t.position-1)))break}else{if(t.position===t.lineStart&&tn(t)||e&&Dt(l))break;if(Nt(l)){if(c=t.line,u=t.lineStart,s=t.lineIndent,Xt(t,!1,-1),t.lineIndent>=n){a=!0,l=t.input.charCodeAt(t.position);continue}t.position=o,t.line=c,t.lineStart=u,t.lineIndent=s;break}}a&&(Kt(t,i,o,!1),nn(t,t.line-c),i=o=t.position,a=!1),Lt(l)||(o=t.position+1),l=t.input.charCodeAt(++t.position)}return Kt(t,i,o,!1),!!t.result||(t.kind=f,t.result=p,!1)}(t,f,1===e)&&(m=!0,null===t.tag&&(t.tag="?")):(m=!0,null===t.tag&&null===t.anchor||Bt(t,"alias node should not have any properties")),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):0===h&&(m=c&&en(t,p))),null!==t.tag&&"!"!==t.tag)if("?"===t.tag){for(u=0,s=t.implicitTypes.length;u<s;u+=1)if((l=t.implicitTypes[u]).resolve(t.result)){t.result=l.construct(t.result),t.tag=l.tag,null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);break}}else jt.call(t.typeMap[t.kind||"fallback"],t.tag)?(l=t.typeMap[t.kind||"fallback"][t.tag],null!==t.result&&l.kind!==t.kind&&Bt(t,"unacceptable node kind for !<"+t.tag+'> tag; it should be "'+l.kind+'", not "'+t.kind+'"'),l.resolve(t.result)?(t.result=l.construct(t.result),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):Bt(t,"cannot resolve a node with !<"+t.tag+"> explicit tag")):Bt(t,"unknown tag !<"+t.tag+">");return null!==t.listener&&t.listener("close",t),null!==t.tag||null!==t.anchor||m}function cn(t){var n,e,r,i,o=t.position,a=!1;for(t.version=null,t.checkLineBreaks=t.legacy,t.tagMap={},t.anchorMap={};0!==(i=t.input.charCodeAt(t.position))&&(Xt(t,!0,-1),i=t.input.charCodeAt(t.position),!(t.lineIndent>0||37!==i));){for(a=!0,i=t.input.charCodeAt(++t.position),n=t.position;0!==i&&!Rt(i);)i=t.input.charCodeAt(++t.position);for(r=[],(e=t.input.slice(n,t.position)).length<1&&Bt(t,"directive name must not be less than one character in length");0!==i;){for(;Lt(i);)i=t.input.charCodeAt(++t.position);if(35===i){do{i=t.input.charCodeAt(++t.position)}while(0!==i&&!Nt(i));break}if(Nt(i))break;for(n=t.position;0!==i&&!Rt(i);)i=t.input.charCodeAt(++t.position);r.push(t.input.slice(n,t.position))}0!==i&&Qt(t),jt.call(Ht,e)?Ht[e](t,e,r):Vt(t,'unknown document directive "'+e+'"')}Xt(t,!0,-1),0===t.lineIndent&&45===t.input.charCodeAt(t.position)&&45===t.input.charCodeAt(t.position+1)&&45===t.input.charCodeAt(t.position+2)?(t.position+=3,Xt(t,!0,-1)):a&&Bt(t,"directives end mark is expected"),an(t,t.lineIndent-1,4,!1,!0),Xt(t,!0,-1),t.checkLineBreaks&&St.test(t.input.slice(o,t.position))&&Vt(t,"non-ASCII line breaks are interpreted as content"),t.documents.push(t.result),t.position===t.lineStart&&tn(t)?46===t.input.charCodeAt(t.position)&&(t.position+=3,Xt(t,!0,-1)):t.position<t.length-1&&Bt(t,"end of the stream or a document separator is expected")}function un(t,n){n=n||{},0!==(t=String(t)).length&&(10!==t.charCodeAt(t.length-1)&&13!==t.charCodeAt(t.length-1)&&(t+="\n"),65279===t.charCodeAt(0)&&(t=t.slice(1)));var e=new Wt(t,n);for(e.input+="\0";32===e.input.charCodeAt(e.position);)e.lineIndent+=1,e.position+=1;for(;e.position<e.length-1;)cn(e);return e.documents}function sn(t,n,e){var r,i,o=un(t,e);if("function"!=typeof n)return o;for(r=0,i=o.length;r<i;r+=1)n(o[r])}function ln(t,n){var e=un(t,n);if(0!==e.length){if(1===e.length)return e[0];throw new q("expected a single document in the stream, but found more")}}var fn={loadAll:sn,load:ln,safeLoadAll:function(t,n,e){if("function"!=typeof n)return sn(t,U.extend({schema:xt},e));sn(t,n,U.extend({schema:xt},e))},safeLoad:function(t,n){return ln(t,U.extend({schema:xt},n))}},pn=Object.prototype.toString,hn=Object.prototype.hasOwnProperty,dn={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},mn=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"];function gn(t){var n,e,r;if(n=t.toString(16).toUpperCase(),t<=255)e="x",r=2;else if(t<=65535)e="u",r=4;else{if(!(t<=4294967295))throw new q("code point within a string may not be greater than 0xFFFFFFFF");e="U",r=8}return"\\"+e+U.repeat("0",r-n.length)+n}function vn(t){this.schema=t.schema||Ct,this.indent=Math.max(1,t.indent||2),this.noArrayIndent=t.noArrayIndent||!1,this.skipInvalid=t.skipInvalid||!1,this.flowLevel=U.isNothing(t.flowLevel)?-1:t.flowLevel,this.styleMap=function(t,n){var e,r,i,o,a,c,u;if(null===n)return{};for(e={},i=0,o=(r=Object.keys(n)).length;i<o;i+=1)a=r[i],c=String(n[a]),"!!"===a.slice(0,2)&&(a="tag:yaml.org,2002:"+a.slice(2)),(u=t.compiledTypeMap.fallback[a])&&hn.call(u.styleAliases,c)&&(c=u.styleAliases[c]),e[a]=c;return e}(this.schema,t.styles||null),this.sortKeys=t.sortKeys||!1,this.lineWidth=t.lineWidth||80,this.noRefs=t.noRefs||!1,this.noCompatMode=t.noCompatMode||!1,this.condenseFlow=t.condenseFlow||!1,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function yn(t,n){for(var e,r=U.repeat(" ",n),i=0,o=-1,a="",c=t.length;i<c;)-1===(o=t.indexOf("\n",i))?(e=t.slice(i),i=c):(e=t.slice(i,o+1),i=o+1),e.length&&"\n"!==e&&(a+=r),a+=e;return a}function bn(t,n){return"\n"+U.repeat(" ",t.indent*n)}function wn(t){return 32===t||9===t}function xn(t){return 32<=t&&t<=126||161<=t&&t<=55295&&8232!==t&&8233!==t||57344<=t&&t<=65533&&65279!==t||65536<=t&&t<=1114111}function An(t){return xn(t)&&65279!==t&&44!==t&&91!==t&&93!==t&&123!==t&&125!==t&&58!==t&&35!==t}function kn(t){return/^\n* /.test(t)}function On(t,n,e,r,i){var o,a,c,u=!1,s=!1,l=-1!==r,f=-1,p=xn(c=t.charCodeAt(0))&&65279!==c&&!wn(c)&&45!==c&&63!==c&&58!==c&&44!==c&&91!==c&&93!==c&&123!==c&&125!==c&&35!==c&&38!==c&&42!==c&&33!==c&&124!==c&&62!==c&&39!==c&&34!==c&&37!==c&&64!==c&&96!==c&&!wn(t.charCodeAt(t.length-1));if(n)for(o=0;o<t.length;o++){if(!xn(a=t.charCodeAt(o)))return 5;p=p&&An(a)}else{for(o=0;o<t.length;o++){if(10===(a=t.charCodeAt(o)))u=!0,l&&(s=s||o-f-1>r&&" "!==t[f+1],f=o);else if(!xn(a))return 5;p=p&&An(a)}s=s||l&&o-f-1>r&&" "!==t[f+1]}return u||s?e>9&&kn(t)?5:s?4:3:p&&!i(t)?1:2}function En(t,n,e,r){t.dump=function(){if(0===n.length)return"''";if(!t.noCompatMode&&-1!==mn.indexOf(n))return"'"+n+"'";var i=t.indent*Math.max(1,e),o=-1===t.lineWidth?-1:Math.max(Math.min(t.lineWidth,40),t.lineWidth-i),a=r||t.flowLevel>-1&&e>=t.flowLevel;switch(On(n,a,t.indent,o,(function(n){return function(t,n){var e,r;for(e=0,r=t.implicitTypes.length;e<r;e+=1)if(t.implicitTypes[e].resolve(n))return!0;return!1}(t,n)}))){case 1:return n;case 2:return"'"+n.replace(/'/g,"''")+"'";case 3:return"|"+Cn(n,t.indent)+jn(yn(n,i));case 4:return">"+Cn(n,t.indent)+jn(yn(function(t,n){var e,r,i=/(\n+)([^\n]*)/g,o=(c=t.indexOf("\n"),c=-1!==c?c:t.length,i.lastIndex=c,Pn(t.slice(0,c),n)),a="\n"===t[0]||" "===t[0];var c;for(;r=i.exec(t);){var u=r[1],s=r[2];e=" "===s[0],o+=u+(a||e||""===s?"":"\n")+Pn(s,n),a=e}return o}(n,o),i));case 5:return'"'+function(t){for(var n,e,r,i="",o=0;o<t.length;o++)(n=t.charCodeAt(o))>=55296&&n<=56319&&(e=t.charCodeAt(o+1))>=56320&&e<=57343?(i+=gn(1024*(n-55296)+e-56320+65536),o++):i+=!(r=dn[n])&&xn(n)?t[o]:r||gn(n);return i}(n)+'"';default:throw new q("impossible error: invalid scalar style")}}()}function Cn(t,n){var e=kn(t)?String(n):"",r="\n"===t[t.length-1];return e+(r&&("\n"===t[t.length-2]||"\n"===t)?"+":r?"":"-")+"\n"}function jn(t){return"\n"===t[t.length-1]?t.slice(0,-1):t}function Pn(t,n){if(""===t||" "===t[0])return t;for(var e,r,i=/ [^ ]/g,o=0,a=0,c=0,u="";e=i.exec(t);)(c=e.index)-o>n&&(r=a>o?a:c,u+="\n"+t.slice(o,r),o=r+1),a=c;return u+="\n",t.length-o>n&&a>o?u+=t.slice(o,a)+"\n"+t.slice(a+1):u+=t.slice(o),u.slice(1)}function Sn(t,n,e){var r,i,o,a,c,u;for(o=0,a=(i=e?t.explicitTypes:t.implicitTypes).length;o<a;o+=1)if(((c=i[o]).instanceOf||c.predicate)&&(!c.instanceOf||"object"==typeof n&&n instanceof c.instanceOf)&&(!c.predicate||c.predicate(n))){if(t.tag=e?c.tag:"?",c.represent){if(u=t.styleMap[c.tag]||c.defaultStyle,"[object Function]"===pn.call(c.represent))r=c.represent(n,u);else{if(!hn.call(c.represent,u))throw new q("!<"+c.tag+'> tag resolver accepts not "'+u+'" style');r=c.represent[u](n,u)}t.dump=r}return!0}return!1}function In(t,n,e,r,i,o){t.tag=null,t.dump=e,Sn(t,e,!1)||Sn(t,e,!0);var a=pn.call(t.dump);r&&(r=t.flowLevel<0||t.flowLevel>n);var c,u,s="[object Object]"===a||"[object Array]"===a;if(s&&(u=-1!==(c=t.duplicates.indexOf(e))),(null!==t.tag&&"?"!==t.tag||u||2!==t.indent&&n>0)&&(i=!1),u&&t.usedDuplicates[c])t.dump="*ref_"+c;else{if(s&&u&&!t.usedDuplicates[c]&&(t.usedDuplicates[c]=!0),"[object Object]"===a)r&&0!==Object.keys(t.dump).length?(!function(t,n,e,r){var i,o,a,c,u,s,l="",f=t.tag,p=Object.keys(e);if(!0===t.sortKeys)p.sort();else if("function"==typeof t.sortKeys)p.sort(t.sortKeys);else if(t.sortKeys)throw new q("sortKeys must be a boolean or a function");for(i=0,o=p.length;i<o;i+=1)s="",r&&0===i||(s+=bn(t,n)),c=e[a=p[i]],In(t,n+1,a,!0,!0,!0)&&((u=null!==t.tag&&"?"!==t.tag||t.dump&&t.dump.length>1024)&&(t.dump&&10===t.dump.charCodeAt(0)?s+="?":s+="? "),s+=t.dump,u&&(s+=bn(t,n)),In(t,n+1,c,!0,u)&&(t.dump&&10===t.dump.charCodeAt(0)?s+=":":s+=": ",l+=s+=t.dump));t.tag=f,t.dump=l||"{}"}(t,n,t.dump,i),u&&(t.dump="&ref_"+c+t.dump)):(!function(t,n,e){var r,i,o,a,c,u="",s=t.tag,l=Object.keys(e);for(r=0,i=l.length;r<i;r+=1)c=t.condenseFlow?'"':"",0!==r&&(c+=", "),a=e[o=l[r]],In(t,n,o,!1,!1)&&(t.dump.length>1024&&(c+="? "),c+=t.dump+(t.condenseFlow?'"':"")+":"+(t.condenseFlow?"":" "),In(t,n,a,!1,!1)&&(u+=c+=t.dump));t.tag=s,t.dump="{"+u+"}"}(t,n,t.dump),u&&(t.dump="&ref_"+c+" "+t.dump));else if("[object Array]"===a){var l=t.noArrayIndent&&n>0?n-1:n;r&&0!==t.dump.length?(!function(t,n,e,r){var i,o,a="",c=t.tag;for(i=0,o=e.length;i<o;i+=1)In(t,n+1,e[i],!0,!0)&&(r&&0===i||(a+=bn(t,n)),t.dump&&10===t.dump.charCodeAt(0)?a+="-":a+="- ",a+=t.dump);t.tag=c,t.dump=a||"[]"}(t,l,t.dump,i),u&&(t.dump="&ref_"+c+t.dump)):(!function(t,n,e){var r,i,o="",a=t.tag;for(r=0,i=e.length;r<i;r+=1)In(t,n,e[r],!1,!1)&&(0!==r&&(o+=","+(t.condenseFlow?"":" ")),o+=t.dump);t.tag=a,t.dump="["+o+"]"}(t,l,t.dump),u&&(t.dump="&ref_"+c+" "+t.dump))}else{if("[object String]"!==a){if(t.skipInvalid)return!1;throw new q("unacceptable kind of an object to dump "+a)}"?"!==t.tag&&En(t,t.dump,n,o)}null!==t.tag&&"?"!==t.tag&&(t.dump="!<"+t.tag+"> "+t.dump)}return!0}function Fn(t,n){var e,r,i=[],o=[];for(Tn(t,i,o),e=0,r=o.length;e<r;e+=1)n.duplicates.push(i[o[e]]);n.usedDuplicates=new Array(r)}function Tn(t,n,e){var r,i,o;if(null!==t&&"object"==typeof t)if(-1!==(i=n.indexOf(t)))-1===e.indexOf(i)&&e.push(i);else if(n.push(t),Array.isArray(t))for(i=0,o=t.length;i<o;i+=1)Tn(t[i],n,e);else for(i=0,o=(r=Object.keys(t)).length;i<o;i+=1)Tn(t[r[i]],n,e)}function _n(t,n){var e=new vn(n=n||{});return e.noRefs||Fn(t,e),In(e,0,t,!0,!0)?e.dump+"\n":""}var Nn={dump:_n,safeDump:function(t,n){return _n(t,U.extend({schema:xt},n))}};function Ln(t){return function(){throw new Error("Function "+t+" is deprecated and cannot be used.")}}var Rn={Type:V,Schema:Z,FAILSAFE_SCHEMA:J,JSON_SCHEMA:ot,CORE_SCHEMA:at,DEFAULT_SAFE_SCHEMA:xt,DEFAULT_FULL_SCHEMA:Ct,load:fn.load,loadAll:fn.loadAll,safeLoad:fn.safeLoad,safeLoadAll:fn.safeLoadAll,dump:Nn.dump,safeDump:Nn.safeDump,YAMLException:q,MINIMAL_SCHEMA:J,SAFE_SCHEMA:xt,DEFAULT_SCHEMA:Ct,scan:Ln("scan"),parse:Ln("parse"),compose:Ln("compose"),addConstructor:Ln("addConstructor")},Dn=function(t){var n=function(t,n,e){return o(t[n])?e:t[n]},e=t.map((function(t){var e={name:n(t,"name",v(t.path)),description:n(t,"description",""),type:n(t,"type","files")};return e.metadata=function(t,n){var e={};return Object.assign(e,t),n.forEach((function(t){e.hasOwnProperty(t)&&delete e[t]})),e}(t,["name","description","type"]),e}));return F(e,{name:"character",description:"character",type:"character"})},Mn=function(t,n){return new Promise((function(e,r){var i=function(t){try{return e(n(t))}catch(t){return r(t)}};try{return new Promise((function(n,e){return t.then?t().then(n,e):n(t())})).then(e,i)}catch(t){i(t)}}))},zn=function(t,n){return Mn(t,(function(){return null}))},Un=function(t){return O(N(t),"data.txt")},Gn=function(t){return new Promise((function(n,e){var r;return r=Vn(t),R((function(){return Hn(r)}),(function(){var n=Un(t);if(j(n)){var e=y(n).join("\n");return Rn.safeLoad(e)}return[]})).then(n,e)}))},qn=function(t,n){return new Promise((function(e,r){var i;return i=Vn(n),R((function(){return Hn(i)}),(function(){var e=Rn.safeDump(t);b(Un(n),e.split("\n"))})).then(e,r)}))},$n=function(t,n){var e=O(N(t),n);return w.exists(e)||w.create(e,{recursive:!0}),e},Wn=function(t,n,e){return void 0===e&&(e={}),new Promise((function(r,i){var o;return o=Vn(n),R((function(){return Hn(o)}),(function(){return new Promise((function(r,i){var o,a,c,u;return Gn(n).then((function(s){try{for(var l in t=Bn(t,o=s),a=$n(n,t),null===o&&(o=[]),c=o.map((function(t){return t.name})),u=0,c.includes(t)?u=c.findIndex((function(n){return n===t})):(u=o.length,o[u]={}),o[u].name=t,e)Array.isArray(e[l])&&!e[l].length||void 0===e[l]?delete o[u][l]:o[u][l]=e[l];return qn(o,n).then((function(t){try{return r(a)}catch(t){return i(t)}}),i)}catch(t){return i(t)}}),i)}))})).then(r,i)}))},Yn=function(t,n){return new Promise((function(e,r){var i;return i=Vn(n),R((function(){return Hn(i)}),(function(){return new Promise((function(e,r){var i,o;return Gn(n).then((function(a){try{return t=Bn(t,i=a),(o=i.map((function(t){return t.name}))).includes(t)?e(i.find((function(n){return n.name===t}))):(D("Pin not found, pins available in registry: "+o.join(", ")),r(new Error("Pin '"+t+"' not found in '"+n.name+"' board.")))}catch(t){return r(t)}}),r)}))})).then(e,r)}))},Bn=function(t,n){var e=n.map((function(t){return t.name})),r="";r=new RegExp(/\//g).test(t)?"^"+t+"$":".*/"+t+"$";var i=e.filter((function(t){return new RegExp(r,"gi").test(t)}));return 1===i.length&&(t=i),t},Vn=function(t){return function(t,n){return r.get("fileExists")(t)}(Un(t)+".lock",a("pins.lock.timeout",1/0))},Hn=function(t){return function(t){return r.get("fileExists")(t)}(t)},Kn=function(t,n){return t=E(t,{winslash:"/",mustWork:!1}),n=E(n,{winslash:"/",mustWork:!1}),t.startsWith(n)&&(t=t.substr(n.length+1,t.length)),t.replace("^/","")},Zn=function(t,n){var e=N(n);return t.startsWith(e)?t:E(O(e,t),{mustWork:!1})},Jn=function(t,n){return new Promise((function(e,r){var i,a;return i=n.replace(/^https?:\/\//g,""),zn((function(){return new Promise((function(n,e){return Yn(i,t).then((function(t){try{return n(t||null)}catch(t){return e(t)}}),e)}))})).then(function(n){try{if(!o(a=n))return a.cache={},Wn(i,t,{params:a}).then(function(t){try{return c.call(this)}catch(t){return r(t)}}.bind(this),r);function c(){return e()}return c.call(this)}catch(t){return r(t)}}.bind(this),r)}))},Qn={},Xn="default",te=function(t,n){for(var e=[],r=arguments.length-2;r-- >0;)e[r]=arguments[r+2];M("useMethod",Object.assign.apply(Object,[{object:n}].concat(e))),Qn[t]=Qn[t]||{};var i=(n&&n.class?n.class:n.constructor&&n.constructor.name?n.constructor.name:Xn).toLowerCase();return T(n)&&(i="dataframe"),void 0!==n._content&&(n=n._content),{className:i,object:n}},ne=function(t,n,e){return Qn[t]=Qn[t]||{},Qn[t][n]=e,e},ee=function(t,n){for(var e=[],r=arguments.length-2;r-- >0;)e[r]=arguments[r+2];return new Promise((function(r,i){var o,a,c,u,s;return u=(c=te.apply(void 0,[t,n].concat(e))).className,n=c.object,Qn[t]&&Qn[t][u]?(s=(o=Qn[t])[u].apply(o,[n].concat(e)))&&s.then?s.then(r,i):r(s):Qn[t]&&Qn[t].default?r((a=Qn[t]).default.apply(a,[n].concat(e))):i(new Error("no applicable method for '"+t+"' applied to an object of class '"+u+"'"))}))},re=function(t,n){for(var e,r,i=[],o=arguments.length-2;o-- >0;)i[o]=arguments[o+2];var a=te.apply(void 0,[t,n].concat(i)),c=a.className;if(n=a.object,Qn[t]&&Qn[t][c])return(e=Qn[t])[c].apply(e,[n].concat(i));if(Qn[t]&&Qn[t].default)return(r=Qn[t]).default.apply(r,[n].concat(i));throw new Error("no applicable method for '"+t+"' applied to an object of class '"+c+"'")};function ie(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&-1===n.indexOf(r)&&(e[r]=t[r]);return e}var oe=function(t,n){var e=n.board,r=n.cache,i=n.extract,a=n.version,c=n.files,s=n.signature,f=ie(n,["board","cache","extract","version","files","signature"]);return new Promise((function(n,p){var h,d,m,g;if(o(e))return(h=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return new Promise((function(n,e){var r=function(t){try{return n(null)}catch(t){return e(t)}};try{return xe.apply(void 0,t).then(n,r)}catch(t){r()}}))})(Ie(null),t,{version:a}).then(function(n){try{if(o(d=n)&&o(e)){var c,u,s,l=[];for(c in Se())l.push(c);function f(){if(l.length){if(u=l.shift(),!r)return Jn(u,t).then(function(t){try{return n.call(this)}catch(t){return p(t)}}.bind(this),p);function n(){return h(Ie(u),t,{extract:i,version:a}).then((function(n){try{return o(d=n)?f:(D("Found pin "+t+" in board "+u),[1])}catch(t){return p(t)}}),p)}return n.call(this)}return[1]}return(s=function(t){for(;t;){if(t.then)return void t.then(s,p);try{if(t.pop){if(t.length)return t.pop()?m.call(this):t;t=f}else t=t.call(this)}catch(t){return p(t)}}}.bind(this))(f);function m(){return g.call(this)}}function g(){return o(d)?p(new Error("Failed to retrieve '"+t+"' pin.")):y.call(this)}return g.call(this)}catch(t){return p(t)}}.bind(this),p);{if(!r)return Jn(e,t).then(function(t){try{return v.call(this)}catch(t){return p(t)}}.bind(this),p);function v(){return xe(Ie(e),t,Object.assign.apply(Object,[{extract:i,version:a}].concat(f))).then(function(t){try{return d=t,y.call(this)}catch(t){return p(t)}}.bind(this),p)}return v.call(this)}function y(){return m=se(d),o(m.type)&&(m.type="files"),g=u(d).filter((function(t){return!new RegExp("^"+pe()).test(t)})),g=w.list(g,{fullNames:!0}),"files"==m.type&&g.length>1&&(g=g.filter((function(t){return!/\/data\.txt$/g.test(t)}))),o(s)||(pinVersionSignature(g),s===pin_signature)?n(c?l(g):ce({_content:d,class:m.type})):p(new Error("Pin signature '"+pin_signature+"' does not match given signature."))}}))},ae=function(t,n){var e=n.board,r=n.name,i=n.extended,a=n.metadata,c=ie(n,["board","name","extended","metadata"]);return new Promise((function(n,s){var l,f,p,h,d;(o(e)||0==e.length)&&(e=Se()),t="string"==typeof(d=t)?function(t){void 0===t&&(t="");var n=t.split("/"),e=n[0];return n.pop(),{name:e,owner:n.join("/")}}(d).name:d,o(t)&&!o(r)&&(t=r),l=F(null,{name:"character",description:"character",type:"character",metadata:"character",board:"character"}),e=u(e);var m,g,v,y=[];for(m in e)y.push(m);function b(){if(!y.length)return[1];g=y.shift(),f=e[g],p=Ie(f),h=null;var n=function(){try{return!0===i&&(h=h.map((function(t){return t.hasOwnProperty("metadata")&&(Object.assign(t,t.metadata),delete t.metadata),t}))),h.length>0&&(r=h,o=F(h.map((function(t){return Object.assign(t,{board:f})})),{board:"character"}),a=r.map((function(t,n){var e={};return Object.assign(e,t),Object.assign(e,o[n]),e})),c=Object.assign({},r.columns),Object.assign(c,o.columns),h=F(a,c),n=h,(e=[].concat(t=l).concat(n)).columns={},Object.assign(e.columns,t.columns),Object.assign(e.columns,n.columns),l=e),b}catch(t){return s(t)}var t,n,e,r,o,a,c},o=function(t){try{return D("Error searching '"+f+"' board: "+t),h=Ee(),n()}catch(t){return s(t)}};try{return ke(p,t,Object.assign.apply(Object,[{name:r,extended:i}].concat(c))).then((function(t){try{return h=t,n()}catch(t){return o(t)}}),o)}catch(t){o(t)}}return(v=function(t){for(;t;){if(t.then)return void t.then(v,s);try{if(t.pop){if(t.length)return t.pop()?w.call(this):t;t=b}else t=t.call(this)}catch(t){return s(t)}}}.bind(this))(b);function w(){return o(t)||(l=l.filter((function(n){return n.name===t||!o(n.description)&&new RegExp(t,"i").test(n.description)}))),a||(l=function(t,n){var e={};Object.assign(e,t.columns),Object.keys(e).includes(n)&&delete e[n];var r=t.map((function(t){var e={};return Object.assign(e,t),Object.keys(e).includes(n)&&delete e[n],e}));return F(r,e)}(l,"metadata")),o(r)||(l=l.filter((function(t){return new RegExp("(.*/)?"+r+"$").test(t.name)}))).length&&(l=l.filter((function(t,n){return 0===n}))),l=l.sort((function(t,n){return t.name<n.name})),n(l)}}))},ce=function(t){for(var n=[],e=arguments.length-1;e-- >0;)n[e]=arguments[e+1];return re.apply(void 0,["pinLoad",t].concat(n))},ue=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return re.apply(void 0,["pinFetch"].concat(t))},se=function(t){var n={},e=O(t,"data.txt");if(j(e)){var r=y(e).join("\n");n=Rn.safeLoad(r)}return o(n.type)&&(n.type="files"),n},le=function(t,n,e){var r=Object.assign({path:e},n);!function(t){for(var n in t)o(t[n])&&delete t[n]}(r);var i=Rn.safeDump(r);return b(O(t,"data.txt"),i.split("\n")),r},fe=function(t,n){return o(n.path)||o(t.path)||/https?:\/\//g.test(t.path)||(t.path=O(t.path,n.path)),t=Object.assign(t,n)},pe=function(){return a("pins.versions.path","_versions")},he=function(t){var n=w.list(t,{fullNames:!0});n=n.filter((function(t){return!/(\/|\\)_versions$/g.test(t)}));var e=O(pe(),function(t){var n=t.map((function(t){return I(t)}));return n.length>1?(n=n.join(","),n=I(n)):n[0]}(n));return E(O(E(t),e),{mustWork:!1})},de=function(t,n,e){var r=null;if(function(t,n){return void 0===n&&(n={defaultValue:!1}),n.defaultValue?!1!==t.versions:!0===t.versions}(t)){var i=$n(t,n),o=(r=se(i).versions||[],he(e)),a=Kn(o,e);r.some((function(t){return t===a}))&&(r=r.filter((function(t){return t!==a}))),w.exists(o)&&w.remove(o,{recursive:!0}),w.create(o,{recursive:!0});var c=w.list(e,{fullNames:!0}).filter((function(t){return t!=O(e,pe())}));P(c,o,{recursive:!0}),r=[a].concat(r);var u=se(e);u.versions=r,function(t,n){var e=O(t,"data.txt"),r=Rn.safeDump(n);b(e,r.split("\n"))}(e,u)}return r},me=function(t,n){var e=F(null,{versions:"character"}),r=$n(t,n);return(e=se(r).versions).length>0&&(e={version:e}),e},ge=function(t){t.map((function(t){return t.replace("[^/\\\\]+$","")})).filter((function(t,n,e){return e.indexOf(t)===n})).length>0&&(t=t.map((function(t){return t.replace(/.*(\/|\\)/g,"")})));var n=t.map((function(t){return t.substr(0,7)}));return n.filter((function(t,n,e){return e.indexOf(t)===n})).length==t.length&&(t=n),t},ve=function(t,n){var e=ge(t).indexOf(n);if(-1===e)throw new Error("Version '"+n+"' is not valid, please select from pin_versions().");return t[e]};function ye(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&-1===n.indexOf(r)&&(e[r]=t[r]);return e}var be=function(t,n,e,r){for(var i=[],o=arguments.length-4;o-- >0;)i[o]=arguments[o+4];return new Promise((function(o,a){return o(ee.apply(void 0,["boardPinCreate",t,n,e,r].concat(i)))}))},we=function(t,n){var e=function(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&-1===n.indexOf(r)&&(e[r]=t[r]);return e}(n,[]);return new Promise((function(n,r){return ee.apply(void 0,["boardInitialize",t].concat(e)).then(n,r)}))},xe=function(t,n){for(var e=[],r=arguments.length-2;r-- >0;)e[r]=arguments[r+2];return new Promise((function(r,i){return r(ee.apply(void 0,["boardPinGet",t,n].concat(e)))}))},Ae=function(t,n){for(var e=[],r=arguments.length-2;r-- >0;)e[r]=arguments[r+2];return new Promise((function(r,i){return r(ee.apply(void 0,["boardPinRemove",t,n].concat(e)))}))},ke=function(t,n){for(var e=[],r=arguments.length-2;r-- >0;)e[r]=arguments[r+2];return new Promise((function(r,i){return r(ee.apply(void 0,["boardPinFind",t,n].concat(e)))}))},Oe=function(t,n){for(var e=[],r=arguments.length-2;r-- >0;)e[r]=arguments[r+2];return re.apply(void 0,["boardPinVersions",t,n].concat(e))},Ee=function(){return F(null,{name:"character",description:"character",rows:"numeric",cols:"numeric",class:"numeric"})};var Ce=function(t,n){var e=n.name,r=n.board,i=n.registerCall,o=n.connect,a={name:e,board:null==r?e:r,connect:null==o?"packages"!==e:o,url:n.url,registerCall:i};return/^http:\/\/|^https:\/\//g.test(t)&&(a.url=t,a.board="datatxt",null!=e&&t!==e||(a.name=a.url.replace(/https?:\/\//g,"").replace(/\..*$/g,"")),a.registerCall='pins::board_register(board = "datatxt", name = "'+a.name+'", url = "'+a.url+'")'),null==a.name&&(a.name=t),null==a.board&&(a.board=t),a},je=function(t,n){for(var e=[],r=arguments.length-2;r-- >0;)e[r]=arguments[r+2];t=Ie(t);return f(t,n),t},Pe=function(t,n){var r=Ie(t);return function(t){e("uiViewerClose")(t)}(r),r},Se=function(){M("boardList",{});var t=c(["local"],_()),n=c(d(),t);return n.filter((function(t,n,e){return e.indexOf(t)===n}))},Ie=function(t){o(t)&&(t=_());var n='pins::board_register(board = "'+t+'")';if(!d().includes(t)){var e=Ce(t,{});null!==e.registerCall&&(n=e.registerCall),t=e.name;try{Fe(e.board,{name:e.name,connect:e.connect,registerCall:n,url:e.url})}catch(n){D("Failed to register board "+t+": "+n.toString())}if(!d().includes(t))throw"Board '"+t+"' not a board, available boards: "+Se().join(", ")}return function(t){return h[t]}(t)},Fe=function(t,n){var e=n.name,i=n.cache,o=n.versions,a=function(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&-1===n.indexOf(r)&&(e[r]=t[r]);return e}(n,["name","cache","versions"]);return new Promise((function(n,c){var u;return null==e&&(e=t),null==i&&(i=m()),u=Ce(t,{board:t,name:e,registerCall:a.registerCall,connect:a.connect,url:a.url}),a.url=u.url,function(t,n,e,r){for(var i=[],o=arguments.length-4;o-- >0;)i[o]=arguments[o+4];return new Promise((function(o,a){return null==e?a(new Error("Please specify the 'cache' parameter.")):we(t={board:t,name:n,cache:e,versions:r,class:t},Object.assign.apply(Object,[{cache:e,versions:r}].concat(i))).then((function(n){try{return o(t=n)}catch(t){return a(t)}}),a)}))}(u.board,u.name,i,o,a).then((function(e){try{return t=e,function(t,n){h[t]=n}(u.name,t),null==u.registerCall&&(u.registerCall=function(t,n){return r.get("boardRegisterCode")(t,n)}(t.name,u.name)),!1!==u.connect&&je(t.name,u.registerCall),n(u.name)}catch(t){return c(t)}}),c)}))},Te=Object.freeze({kaggle:"kaggle"}),_e=function(t,n){var e=v(t),r=new Error("Can't auto-generate pin name from object, please specify the 'name' parameter.");if(!e)throw r;var i=e.replace(/[^a-zA-Z0-9-]/g,"-").replace(/^-*|-*$/g,"").replace(/-+/g,"-");if(!i)throw r;return n===Te.kaggle&&i.length<5?i+"-pin":i},Ne=function(t,n){var e,r=["rows","cols","name","description"];return(e=n,o(e)?[]:Object.keys(e)).forEach((function(e){if("columns"===e){var i=["name","type"];Array.isArray(t.columns)&&(t.columns=t.columns.map((function(n,e){return{name:Object.keys(t.columns)[e],type:t.columns[e]}}))),n.columns.forEach((function(n){var e=metadata$columns.filter((function(e,r){return t.columns[r].name===n.name}));1==e.length&&Object.keys(n).forEach((function(r){i.includes(r)||(t.columns[e][r]=n[r])}))}))}else r.includes(e)||(t[e]=n[e])})),t},Le=function(){return r.get("fetch")};var Re=function(t,n){var e=n.name,r=n.component,i=n.extract,o=n.customEtag;void 0===o&&(o="");n.removeQuery,n.config;var a=n.headers,c=n.canFail,u=n.cache;void 0===u&&(u=!0);var s=n.contentLength;void 0===s&&(s=0);var l=n.subpath,f=n.details;void 0===f&&(f={});var p=n.download;return void 0===p&&(p=!0),new Promise((function(n,h){var d,m,y,b,x,k,E,C,j,S,I;return l||(l=e),d=Le(),m=!u,e=e.replace("^https?://",""),y=$n(r,l),p?(b=g(),w.create(b),function(t,n){return new Promise((function(e,r){return zn((function(){return new Promise((function(e,r){return Yn(t,n).then((function(t){try{return t.then(e,r)}catch(t){return r(t)}}),r)}))})).then(e,r)}))}(e,r).then(function(l){try{var p;if(k=(x=l||{}).cache,E=!0,C=0,k)p=Object.keys(k).map((function(t){return k[t].url})),-1===(C=p.findIndex((function(n){return n===t})))?(k={},C=p.length+1):(k=k[C],E=!1);else x.cache={},k={},C=1;if(j=function(t){if(E)throw new Error(t);D(t)},function(t){return Mn(t,(function(t){D(t.message)}))},E?function(t){return t}:function(t){return Mn(t,(function(t){j(t.message)}))},c&&(j=function(t){f.error=t}),(u={}).etag=k.etag||"",u.maxAge=k.maxAge||0,u.changeAge=k.changeAge||(new Date).getTime()-u.maxAge,u.url=t,null,null,D("Checking 'changeAge' header (time, change age, max age): "+new Date+", "+u.changeAge+", "+u.maxAge),f.somethingChanged=!1,(new Date).getTime()>=u.changeAge+u.maxAge||m){var g,F;return!1,o&&o.length?(D("Using custom 'etag' (old, new): "+k.etag+", "+o),u.etag=o,T.call(this)):d(t,{method:"HEAD",headers:a}).then(function(t){try{return(F=t)&&(u.etag=F.headers.etag||"",u.changeAge=(new Date).getTime(),u.maxAge=function(t){if(!t)return null;var n=new RegExp("max-age").test(t);return 1!==n.length?null:(n=t.replace(/.*max-age=/,""),parseFloat(n.replace(/,.*$/,"")))}(F.headers["cache-control"])||2*u.changeAge,s=F.headers["content-length"],D("Checking 'etag' (old, new):  "+k.etag+", "+u.etag)),T.call(this)}catch(t){return h(t)}}.bind(this),h);function T(){var n,e,r;if(g=u.etag||k.etag!==u.etag,E||g||m)return n=v(t),e=O(b,n),D("Downloading "+t+" to "+e),f.somethingChanged=!0,d(t).then((function(n){return n.ok||D("Failed to download remote file: "+t),n})).then(function(t){try{if((r=t).ok)return r.headers["content-type"],r.text().then(function(t){try{return A(t,e),n.call(this)}catch(t){return h(t)}}.bind(this),h);function n(){return i.call(this)}return n.call(this)}catch(t){return h(t)}}.bind(this),h);function i(){return _.call(this)}return i.call(this)}}function _(){return(S=x.cache)[C]=u,i&&(i,i=!0),w.list(b,{fullNames:!0}).forEach((function(t){P(t,y,{overwrite:!0,recursive:!0})})),I=y.replace($n(r,""),""),Wn(e,r,{path:x.path||I,cache:S}).then((function(t){try{return n(y)}catch(t){return h(t)}}),h)}return _.call(this)}catch(t){return h(t)}}.bind(this),h)):n(y)}))},De=function(t,n){return new Promise((function(e,r){return Re(t,n).then((function(t){try{return e(t)}catch(t){return r(t)}}),r)}))};var Me=function(t,n){return new Promise((function(e,c){var s,l,f,h,d,m,y,b,x,A,k,E,I,F;if(s=Object.assign({retrieve:!0},n),f=s.path,h=s.description,d=s.type,m=s.metadata,y=s.extract,b=s.retrieve,l=function(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&-1===n.indexOf(r)&&(e[r]=t[r]);return e}(s,["path","description","type","metadata","extract","retrieve"]),x=l,f=u(f),A=x.customMetadata,k=x.zip,o(y)&&(y=!0),E=Ie(t),I=n.name||function(t){for(var n=[],e=arguments.length-1;e-- >0;)n[e]=arguments[e+1];for(var r=[],i=0;i>t.length;i++)r.push(fun.apply(void 0,[t[i]].concat(n)));return r}(pinPath),D("Storing "+I+" into board "+E.name+" with type "+d),!x.cache)return Jn(E,I).then(function(t){try{return T.call(this)}catch(t){return c(t)}}.bind(this),c);function T(){return f=f.filter((function(t){return!/data\.txt/g.test(t)})),F=g(),w.create(F),R((function(){return unlink(F,{recursive:!0})}),(function(){return new Promise((function(t,n){var e,c,u,s,l;1==f.length&&/^http/g.test(f)&&!/\\.[a-z]{2,4}$/g.test(f)&&a("pins.search.datatxt",!0)&&(s=O(f,"data.txt"),(l=De(s,I,_()))&&(manifest=se(l),f=f+"/"+manifest[f],y=!1));if(u=!1,k?(c=(e=function(t){var n=t[0];return function(t,n){for(i in t)if(!n(i))return!1;return!0}(t,(function(t){return startsWith(t)}))||n===C(n)?n:e(C(n[0]))})(f),w.zip(c.map((function(t){return t.replace(common_path+"/","")})),O(F,"data.zip"),c),u=!0):f.forEach((function(t,n){var e={somethingChanged:!0};if(/^http/g.test(t)&&(t=De(t,I,_(),Object.assign({extract:y,details:e,canFail:!0},opt)),!o(e.error))){try{oe(I,{board:_()})}catch(t){}if(o(null))throw new Error(e.error);return D(e.error),null}if(e.somethingChanged){var i=function(t,n){j(t)&&S(t)>=a("pins.link.size",2)?(O(n,v(t)),r.get("createLink")(O)):P(t,n,{recursive:!0})};if(w.exists(t))for(entry in w.list(t,{fullNames:!0}))i(entry,F);else i(t,F);u=!0}})),u)return function(t){return j(O(t,"data.txt"))}(F)||(m.description=h,m.type=d,m=Ne(m,A),le(F,m,w.list(F,{recursive:!0}))),be.apply(void 0,[E,F,I,m].concat(x)).then(function(t){try{return p(E),g.call(this)}catch(t){return n(t)}}.bind(this),n);function g(){return b?oe(I,Object.assign.apply(Object,[{board:E.name}].concat(x))).then(t,n):t(null)}return g.call(this)}))})).then(e,c)}return T.call(this)}))};var ze=function(t,n,e,r){if(void 0===e&&(e="GET"),t.url&&(n=n.replace("^"+t.url+"/?","")),"function"==typeof t.headers)return t.headers(t,e,n,r);if(t.headers&&(t.headers.length||"string"==typeof t.headers||t.headers.request)||!t.headers)return t.headers;throw"Unsupported class for board headers: "+typeof t.headers},Ue=function(t,n){if(void 0===n&&(n=!1),!j(t)&&n)return[];var e=y(t).join("\n"),r=Rn.safeLoad(e);return r.map?r:[r]},Ge=function(t){var n=Rn.safeLoad(t);return n.map?n:[n]};function qe(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&-1===n.indexOf(r)&&(e[r]=t[r]);return e}var $e=function(t){return new Promise((function(n,e){var r,i,o,a,c,u,s,l;return t.url?(r="data.txt",t.indexRandomize&&(r+="?rand="+Math.round(1e8*Math.random())),i=O(t.url,r),Le()(i,{headers:ze(t,"data.txt")}).then((function(n){if(n.ok)return n.text();throw new Error("Failed to retrieve data.txt file from "+t.url+".")})).then((function(r){try{return o=r,a=g(),w.create(a),A(o,a),c=O(N(t),"data.txt"),u=Ue(c,!0),s=(s=Ue(a)).map((function(t){var n=u.filter((function(n){return n.path===t.path}));return 1==n.length&&(t.cache=n[0].cache),t})),u=s,l=Rn.safeDump(u),b(c,l.split("\n")),n()}catch(t){return e(t)}}),e)):e(new Error("Invalid 'url' in '"+t.name+"' board."))}))},We=function(t,n,e){var r=Ue(O(N(t),"data.txt"));if(!(r=r.filter((function(t){return t.name===n}))).length&&t.needsIndex)throw new Error("Could not find '"+n+"' pin in '"+t.name+"' board.");var i=r.length?r[0]:{path:n},o=new RegExp(".*/.*\\.[a-zA-Z]+$").test(i.path)?C(i.path):i.path;return{pathGuess:o=new RegExp("^https?://").test(o)?o:O(t.url,o),indexEntry:i}},Ye=function(t,n,e,r){return new Promise((function(r,i){var o,a,c,u;return o=We(t,n),a=o.pathGuess,c=o.indexEntry,u=O(a,"data.txt"),De(u,{name:n,component:t,canFail:!0,download:e,headers:ze(t,u)}).then((function(t){try{return r({pathGuess:a,indexEntry:c,downloadPath:u})}catch(t){return i(t)}}),i)}))},Be=function(t){var n=t.board,e=t.name,r=t.files,i=t.path;return new Promise((function(t,o){var a,c;function u(){var t=c(),n=t[0],e=t[1];return s.bind(this,n,e)}function s(t,r){var a,s,l,f,p,h;return c=function(){return[t,r]},!(r[1]=r[0].next()).done&&(t=r[1].value,1)?(a=O(e,t).replace(/\/\//g,"/"),s=O(n.url,a),l=E(O(i,t)),f=Le(),p=k(l),f(s,{method:"PUT",body:p,headers:ze(n,a,"PUT",l)}).then((function(n){try{return(h=n).ok?u:o(new Error("Failed to upload '"+t+"' to '"+s+"'. Error: "+h.statusText))}catch(t){return o(t)}}),o)):[1]}return(a=function(t){for(;t;){if(t.then)return void t.then(a,o);try{if(t.pop){if(t.length)return t.pop()?l.call(this):t;t=u}else t=t.call(this)}catch(t){return o(t)}}}.bind(this))(s.bind(this,void 0,[r[Symbol.iterator]()]));function l(){return t()}}))},Ve=function(t){var n=t.board,e=t.path,r=t.operation,i=t.name,o=t.metadata;return new Promise((function(t,a){var c,u,s,l,f,p,h,d,m,g,v;return c="data.txt",u=O(n.url,c),s="data.txt",n.indexRandomize&&(s=c+"?rand="+(10*Math.random()^8)),(l=Le())(O(n.url,s),{headers:ze(n,s)}).then(function(s){try{return p=[],(f=s).ok?f.text().then(function(t){try{return p=Ge(t),y.call(this)}catch(t){return a(t)}}.bind(this),a):"remove"===r?a(new Error("Failed to retrieve latest data.txt file, the pin was partially removed.")):y.call(this);function y(){if(h=p.map((function(t){return t.path===e})),(d=h.length?h.filter((function(t){return t})):p.length).length||(d=p.length),"create"===r)Object.keys(o).forEach((function(t){o[t]||(o[t]=null)})),o.columns=null,p[d]={path:e},i&&(p[d].name=i),Object.assign.apply(Object,[p[d]].concat(o));else{if("remove"!==r)return a(new Error("Operation "+r+" is unsupported."));d<=p.length&&(p[d]=null)}return c=O(N(n),"data.txt"),function(t,n){var e=Rn.safeDump(t);b(n,e.split("\n"))}(p,c),m=E(c),g=k(m),l(u,{method:"PUT",body:g,headers:ze(n,"data.txt","PUT",m)}).then(function(e){try{return(v=e).ok?(n.indexUpdated&&"create"===r&&n.indexUpdated(n),t()):v.text().then((function(t){try{return a(new Error("Failed to update data.txt file: "+t))}catch(t){return a(t)}}),a)}catch(t){return a(t)}}.bind(this),a)}}catch(t){return a(t)}}.bind(this),a)}))},He=function(t,n){return new Promise((function(e,r){var i,o,a,c,u,s,l,f,p,h,d;return a=(i=n).url,c=i.browseUrl,u=i.headers,s=i.bucket,l=i.indexUpdated,f=void 0!==(f=i.indexRandomize)&&f,p=void 0===(p=i.needsIndex)||p,h=void 0===(h=i.cache)?m():h,o=qe(i,["url","browseUrl","headers","bucket","indexUpdated","indexRandomize","needsIndex","cache"]),d=o,a?(t.url=a.replace(/(\/)?data.txt$/g,""),t.headers=u,t.needsIndex=p,t.browseUrl=c||a,t.indexUpdated=l,t.bucket=s,t.indexRandomize=f,Object.keys(d).forEach((function(n){t[n]=d[n]})),$e(t).then((function(n){try{return e(t)}catch(t){return r(t)}}),r)):r(new Error("The 'datatxt' board requires a 'url' parameter."))}))},Ke=function(t,n,e){return new Promise((function(r,i){var a,c,u,s,l,f,p,h,d,m;return c=(a=e).extract,u=a.version,s=void 0===(s=a.download)||s,qe(a,["extract","version","download"]),Ye(t,n,s).then(function(e){try{if(f=(l=e).indexEntry,p=l.pathGuess,h=l.downloadPath,d=$n(t,n),m=se(d),u)return m.versions.includes(u)||(u=ve(m.versions,u)),h=O(p,O(u,"data.txt")),d=O(d,u),De(h,{name:n,component:t,canFail:!0,headers:ze(t,h),subpath:O(n,u)}).then(function(t){try{return m=se(d),p=O(p,u),a.call(this)}catch(t){return i(t)}}.bind(this),i);function a(){var e;m?(h=f.path,(e=function(t){var n=se(t);return o(n.path)?null:ue({path:n.path,class:n.type})}(d))?(h="",h=new Regexp("^https?://").test(e)?e:O(p,e)):(f.path=null,le(d,f,f.path))):h=O(t.url,n);return new RegExp("https?://").test(h)||(h=O(t.url,h)),De(h,{name:n,component:t,extract:c,download:s,headers:ze(t,h)}).then((function(t){try{return r(d=t)}catch(t){return i(t)}}),i)}return a.call(this)}catch(t){return i(t)}}.bind(this),i)}))},Ze=function(t,n,e){return new Promise((function(n,r){var i,o;return $e(t).then(function(a){try{if(i=Ue(O(N(t),"data.txt")),e.extended)return n(i);var c,u,s,l;if(o=i.map((function(t){return{name:t.name||v(t.path),description:t.description||"",type:t.type||"files",metadata:t,stringsAsFactors:!1}})),e.name&&(o=o.filter((function(t){return t.name===agrs.name}))),1===o.length)return c=JSON.parse(o[0].metadata),u=new RegExp("\\.[a-zA-Z]+$").test(c.path)?C(c.path):c.path,s=O(t.url,O(u,"data.txt")),fetch(s,{headers:ze(t,s)}).then(function(t){try{var n;if((l=t).ok)return l.text().then(function(t){try{return n=Ge(t),c=fe(c,n),o.metadata=c,e.call(this)}catch(t){return r(t)}}.bind(this),r);function e(){return f.call(this)}return e.call(this)}catch(t){return r(t)}}.bind(this),r);function f(){return n(o)}return f.call(this)}catch(t){return r(t)}}.bind(this),r)}))},Je=function(t,n,e,r,i){return new Promise((function(i,o){var a;return de(t,e,n),a=w.list(n,{recursive:!0}).map((function(t){return t.split("\\").pop().split("/").pop()})),Be({board:t,name:e,files:a,path:n}).then((function(n){try{return Ve({board:t,path:e,operation:"create",name:e,metadata:r}).then((function(t){try{return i()}catch(t){return o(t)}}),o)}catch(t){return o(t)}}),o)}))},Qe=function(t,n,e){return new Promise((function(e,r){var i,o;return(i=function(t,n){return new Promise((function(e,r){if(1!==Ze(t,t.name,{metadata:!0}).length)return r(new Error("Pin '"+n+"' not found."));var i=results[0].metadata,o=i.path;return i.versions.forEach((function(e){return new Promise((function(r,i){var a,c,u,s,l;return a=We(t,n).pathGuess,c=O(O(a,e),"data.txt"),u=O($n(t,n),e),s=O(n,e),De(c,{name:n,component:t,canFail:!0,headers:ze(t,c),subpath:s}).then((function(t){try{return l=se(u),o=o.concat([O(s,l.path),O(s,"data.txt")]),r()}catch(t){return i(t)}}),i)}))})),e(o)}))}(t,n)).push(O(n,"data.txt")),o=Le(),i.forEach((function(n){return new Promise((function(e,r){var i,a;return i=O(t.url,n),o(i,{method:"DELETE",headers:ze(t,n,"DELETE")}).then(function(i){try{if(!(a=i).ok)return a.text().then(function(e){try{return console.warning("Failed to remove '"+n+"' from '"+t.name+"' board. Error: "+e),o.call(this)}catch(t){return r(t)}}.bind(this),r);function o(){return e()}return o.call(this)}catch(t){return r(t)}}.bind(this),r)}))})),Ve({board:t,path:n,operation:"remove",name:n}).then((function(i){try{return unlink($n(t,n),{recursive:!0}),e()}catch(t){return r(t)}}),r)}))},Xe=function(t,n,e){return new Promise((function(r,i){var o,a;return a=void 0===(a=(o=e).download)||a,qe(o,["download"]),Ye(t,n,a).then((function(e){try{return r(me(t,n))}catch(t){return i(t)}}),i)}))};var tr=function(t,n,e,i){var o=(new Date).toUTCString(),a=t.bucket;if(new RegExp("^https?://").test(e)){var c=e.replace("^https?://","");e=c.replace("^[^/]+/",""),a=c.replace("//..*","")}var u=[n,"","application/octet-stream","","x-amz-date:"+o,O("/"+a,e)].join("\n"),s=r.get("sha1")(u,t.secret||"");return{Host:a+"."+t.host,"x-amz-date":o,"Content-Type":"application/octet-stream",Authorization:"AWS "+t.key+":"+s}},nr=function(t,n){return new Promise((function(e,i){var o,a,c,u,s,l,f,p,h;return a=r.get("env"),c=void 0===(c=(o=n).bucket)?a("AWS_BUCKET"):c,u=void 0===(u=o.key)?a("AWS_ACCESS_KEY_ID"):u,s=void 0===(s=o.secret)?a("AWS_SECRET_ACCESS_KEY"):s,l=o.cache,f=void 0===(f=o.host)?"s3.amazonaws.com":f,p=function(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&-1===n.indexOf(r)&&(e[r]=t[r]);return e}(o,["bucket","key","secret","cache","host"]),t.bucket=c,c?u?s?(h=Object.assign({},p,{name:t.name,url:"http://"+c+"."+f,cache:l,headers:tr,needsIndex:!1,key:u,secret:s,bucket:c,connect:!1,browseUrl:"https://s3.console.aws.amazon.com/s3/buckets/"+c+"/",host:f}),He(t,h).then((function(n){try{return e(t)}catch(t){return i(t)}}),i)):i(new Error("The 's3' board requires a 'secret' parameter.")):i(new Error("The 's3' board requires a 'key' parameter.")):i(new Error("The 's3' board requires a 'bucket' parameter."))}))},er=function(t){return"txt"===t.split(".").pop()?"text/plain":""};var rr=function(t,n,e,i){var o=(new Date).toUTCString(),a="2015-04-05",c=t.container,u=t.account;if(new RegExp("^https?://").test(e)){var s=e.replace("^https?://",""),l=s.replace("^[^/]+/","");u=s.replace("\\..*",""),e=l.replace("^[^/]+/",""),c=l.replace("/.*","")}var f="",p="";i&&(f=S(i),p=er(i));var h=[n,"\n",f,"",p,"\n\n\n\n\n","x-ms-blob-type:BlockBlob","x-ms-date:"+o,"x-ms-version:2015-04-05","/"+u+"/"+c+"/"+e].join("\n");return{"x-ms-date":o,"x-ms-version":a,"x-ms-blob-type":"BlockBlob",Authorization:"SharedKey "+u+":"+r.get("sha1")(h,t.secret||"")}},ir=function(t,n){return new Promise((function(e,i){var o,a,c,u,s,l,f,p,h;return a=r.get("env"),c=void 0===(c=(o=n).container)?a("AZURE_STORAGE_CONTAINER"):c,u=void 0===(u=o.account)?a("AZURE_STORAGE_ACCOUNT"):u,s=void 0===(s=o.key)?a("AZURE_STORAGE_KEY"):s,l=o.cache,f=function(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&-1===n.indexOf(r)&&(e[r]=t[r]);return e}(o,["container","account","key","cache"]),c?u?s?(p="https://"+u+".blob.core.windows.net/"+c,h=Object.assign({},f,{name:t.name,url:p,cache:l,headers:rr,needsIndex:!1,container:c,account:u,key:s,connect:!1,browseUrl:"https://portal.azure.com"}),He(t,h).then((function(n){try{return e(Ie(t.name))}catch(t){return i(t)}}),i)):i(new Error("The 'azure' board requires a 'key' parameter.")):i(new Error("The 'azure' board requires an 'account' parameter.")):i(new Error("The 'azure' board requires a 'container' parameter."))}))};var or=function(){var t=r.get("env")("gcloud.binary.path"),n=r.get("getOption")("gcloud.binary.path"),e=t||(n||"");return e?E(e):(function(t){var n=r.get("env"),e=r.get("which");if("win32"===r.get("platform")()){var i=E(n("localappdata"),{winslash:"/"}),o=O("Google/Cloud SDK/google-cloud-sdk/bin",t+".cmd");return[function(){return O(i,o)},function(){return O(n("ProgramFiles"),o)},function(){return O(n("ProgramFiles(x86)"),o)}]}var a=t;return[function(){return e(a)},function(){return"~/google-cloud-sdk/bin/"+a},function(){return O(n("GCLOUD_INSTALL_PATH")||"~/google-cloud-sdk",O("bin",a))}]}("gcloud").forEach((function(t){if(j(t()))return E(t())})),null)},ar=function(t){return new Promise((function(n,e){var r,i;return r={cacheControl:"private, max-age=0, no-transform",name:"data.txt"},Le()("https://storage.googleapis.com/storage/v1/b/"+t.bucket+"./o/"+data.txt,Object.assign({method:"PATCH",body:r},ze(t,"o/data.txt","PATCH"))).then(function(t){try{if(!(i=t).ok)return i.text().then(function(t){try{return console.warning("Failed to update data.txt metadata: "+t),r.call(this)}catch(t){return e(t)}}.bind(this),e);function r(){return n()}return r.call(this)}catch(t){return e(t)}}.bind(this),e)}))},cr=function(t,n,e,r){var i=null;return r&&(i=er(r)),{Authorization:"Bearer "+t.token,"Content-Type":i}},ur=function(t,n){return new Promise((function(e,i){var o,a,c,u,s,l,f,p;if(a=r.get("env"),c=void 0===(c=(o=n).bucket)?a("GCLOUD_STORAGE_BUCKET"):c,u=void 0===(u=o.token)?a("GOOGLE_STORAGE_ACCESS_TOKEN"):u,s=o.cache,l=function(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&-1===n.indexOf(r)&&(e[r]=t[r]);return e}(o,["bucket","token","cache"]),!c)return i(new Error("Board 'gcloud' requires a 'bucket' parameter."));if(!u){var h;if(!(h=or()))return i(new Error("Board 'gcloud' requires an 'access' parameter with a Google Cloud Access Token."));u=r.get("exec")(h+" 'auth', 'print-access-token'")}return f="https://storage.googleapis.com/"+c,p=Object.assign({},l,{name:t.name,url:f,headers:cr,cache:s,bucket:c,token:u,browse_url:"https://console.cloud.google.com/storage/browser/"+c,indexRandomize:!0,indexUpdated:ar}),He(t,p).then((function(n){try{return e(boardGet(t.name))}catch(t){return i(t)}}),i)}))};var sr=function(t,n,e,i){var o=(new Date).toUTCString(),a=t.space;if(new RegExp("^https?://").test(e)){var c=u.replace("^https?://",""),u=c.replace("^[^/]+/","");a=c.replace("\\..*","")}var s=[n,"","application/octet-stream",o,O(a,e)].join("\n"),l=r.get("sha1")(s,t.secret||"");return{Host:a+"."+t.datacenter+"."+t.host,Date:o,"Content-Type":"application/octet-stream",Authorization:"AWS "+t.key+":"+l}},lr=function(t,n){return new Promise((function(e,i){var o,a,c,u,s,l,f,p,h,d,m;return a=r.get("env"),c=void 0===(c=(o=n).space)?a("DO_SPACE"):c,u=void 0===(u=o.key)?a("DO_ACCESS_KEY_ID"):u,s=void 0===(s=o.secret)?a("DO_SECRET_ACCESS_KEY"):s,l=void 0===(l=o.datacenter)?a("DO_DATACENTER"):l,f=o.cache,p=void 0===(p=o.host)?"digitaloceanspaces.com":p,h=function(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&-1===n.indexOf(r)&&(e[r]=t[r]);return e}(o,["space","key","secret","datacenter","cache","host"]),c?u?s?l?(t.space=c,d="https://"+t.space+"."+l+"."+p,m=Object.assign({},h,{name:t.name,url:d,cache:f,headers:sr,key:u,secret:s,space:c,datacenter:l,browseUrl:"https://cloud.digitalocean.com/spaces/"+c,host:p}),He(t,m).then((function(n){try{return e(boardGet(t.name))}catch(t){return i(t)}}),i)):i(new Error("The 'dospace' board requires a 'datacenter' parameter.")):i(new Error("The 'dospace' board requires a 'secret' parameter.")):i(new Error("The 'dospace' board requires a 'key' parameter.")):i(new Error("The 'dospace' board requires a 'space' parameter."))}))},fr=function(t,n){return e("getFunction")(t,n)},pr=function(t,n){return new Promise((function(e,r){var i,o,a,c;return i=""+t.server+n,o=Le(),a=function(t,n,e,r){var i={};return hr(t)?i.Authorization="Key "+t.key:i=rsconnectTokenHeaders(t,rsconnectUrlFromPath(t,n),e,r),i["Content-Type"]="application/json",i}(t,n,"GET"),o(i,{headers:a}).then(function(t){try{return(c=t).ok?c.json().then(e,r):c.text().then((function(t){try{return r(new Error("Failed to retrieve "+i+": "+t))}catch(t){return r(t)}}),r)}catch(t){return r(t)}}.bind(this),r)}))},hr=function(t){return!!t.key},dr=function(t){var n={accounts:fr("accounts","rsconnect"),accountInfo:fr("accountInfo","rsconnect"),serverInfo:fr("serverInfo","rsconnect"),signatureHeaders:fr("signatureHeaders","rsconnect"),httpFunction:fr("httpFunction","rsconnect")};if(!n.accounts)throw new Error("RStudio Connect is not registered, please install the 'rsconnect' package or specify an API key.");var e=n.accounts();if(!e)throw new Error("RStudio Connect is not registered, please add a publishing account or specify an API key.");if(t.server||(t.serverName=e.server[1]),t.account||(t.account=e[e.server===t.serverName].name),1!==t.account.length)throw new Error("Multiple accounts ("+t.account.join(", ")+") are associated to this server, please specify the correct account parameter in board_register().");return t.server=n.serverInfo(t.serverName).url.replace("/__api__",""),t},mr=function(t){return new Promise((function(n,e){return function(t){return new Promise((function(n,e){var r;return pr(t,"/__api__/server_settings").then((function(t){try{return r=t.version,n(r)}catch(t){return e(t)}}),e)}))}(t).then((function(t){try{return n(t>"1.7.7")}catch(t){return e(t)}}),e)}))};function gr(t,n){n=n||",";for(var e=new RegExp("(\\"+n+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+n+"\\r\\n]*))","gi"),r=[[]],i=null;i=e.exec(t);){var o=i[1];if(o.length&&o!=n&&r.push([]),i[2])var a=i[2].replace(new RegExp('""',"g"),'"');else a=i[3];r[r.length-1].push(a)}return r}var vr=function(t,n){try{return function(t,n){if(t.length>0){var e=Object.keys(t[0]).join(",");b(n,e)}var r=t.map((function(t){return Object.keys(t).map((function(n){return t[n]})).join(",")}));b(n,r)}(t,n)}catch(t){D("Failed to save data frame as CSV file: "+t)}};return ne("pin","default",(function(t,n){return void 0===n&&(n={}),new Promise((function(e,r){var i,o,a,c,u,s;return M("pinDefault",{x:t,opts:n}),o=(i=n).description,a=i.board,c=function(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&-1===n.indexOf(r)&&(e[r]=t[r]);return e}(i,["description","board"]),u=n.name||_e(t,a),s=g(),w.create(s),A(JSON.stringify(t),O(s,"data.json")),Me(a,Object.assign.apply(Object,[{},{name:u,description:o,path:s,type:"default",metadata:[]}].concat(c))).then(e,r)}))})),ne("pin","string",(function(t,n){return void 0===n&&(n={name:null,description:null,board:null}),new Promise((function(e,r){var i,o,a,c,s,l,f;return o=(i=n).name,a=i.description,c=i.board,s=function(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&-1===n.indexOf(r)&&(e[r]=t[r]);return e}(i,["name","description","board"]),f=(l=u(t)).length>0?"zip":x.fileExt(l),Me(c,Object.assign.apply(Object,[{},{name:o,description:a,path:l,type:"files",metadata:{extension:f}}].concat(s))).then(e,r)}))})),ne("pin","dataframe",(function(t,n){return void 0===n&&(n={name:null,description:null,board:null}),new Promise((function(e,r){var i,a,c,u,s,l,f;return c=(i=n).name,u=i.description,s=i.board,a=function(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&-1===n.indexOf(r)&&(e[r]=t[r]);return e}(i,["name","description","board"]),l=a,o(c)&&(c=_e(t,s)),f=g(),w.create(f),A(JSON.stringify(t),O(f,"data.json")),vr(t,O(f,"data.csv")),R((function(){return unlink(f)}),(function(){return new Promise((function(n,e){var r,i;return r=(i=t).hasOwnProperty("columns")?Object.keys(i.columns):i.length>0?Object.keys(i[0]):[],{rows:t.length,cols:r.length,columns:r},Me(s,Object.assign.apply(Object,[{},{name:c,description:u,path:f,type:"table",metadata:[]}].concat(l))).then(n,e)}))})).then(e,r)}))})),ne("pinPreview","default",(function(t){for(var n=[],e=arguments.length-1;e-- >0;)n[e]=arguments[e+1];return t})),ne("pinLoad","default",(function(t){for(var n=[],e=arguments.length-1;e-- >0;)n[e]=arguments[e+1];return JSON.parse(k(O(t,"data.json")))})),ne("pinFetch","default",(function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return t.path})),ne("pinLoad","files",(function(t,n){!function(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&-1===n.indexOf(r)&&(e[r]=t[r])}(n,[]);return w.list(t,{recursive:!0,fullNames:!0}).filter((function(t){return!/data\.txt$/g.test(t)}))})),ne("pinLoad","table",(function(t){for(var n=[],e=arguments.length-1;e-- >0;)n[e]=arguments[e+1];var r=O(t,"data.json"),i=O(t,"data.csv"),o=null;if(j(r))o=JSON.parse(y(r).join("\n\r"));else{if(!j(i))throw new Error("A 'table' pin requires CSV or JSON files.");o=gr(y(i).filter((function(t){return t})).join("\n"))}return o})),ne("boardBrowse","default",(function(t){for(var n=[],e=arguments.length-1;e-- >0;)n[e]=arguments[e+1];return null})),ne("boardPinVersions","default",(function(t,n){for(var e=[],r=arguments.length-2;r-- >0;)e[r]=arguments[r+2];return F(null,{version:"character"})})),ne("boardInitialize","default",(function(t){for(var n=[],e=arguments.length-1;e-- >0;)n[e]=arguments[e+1];throw new Error("Board '"+t.name+"' is not a valid board.")})),ne("boardInitialize","local",(function(t,n){ye(n,[]);return w.exists(t.cache)||w.create(t.cache,{recursive:!0}),t})),ne("boardPinCreate","local",(function(t,n,e,r){for(var i=[],o=arguments.length-4;o-- >0;)i[o]=arguments[o+4];return new Promise((function(i,o){var a,c,u,s;return de(t,e,n),a=$n(t,e),c=w.list(a,{fullNames:!0}).filter((function(t){return/(\/|\\)_versions/gi.test(t)})),w.remove(c,{recursive:!0}),w.exists(a)||w.create(a),P(w.list(n,{fullNames:!0}),a,{recursive:!0}),r.columns=null,u=N(t),s=Object.assign({path:Kn(a,{basePath:u})},r),Wn(e,t,s).then(i,o)}))})),ne("boardPinFind","local",(function(t,n,e){ye(e,[]);return new Promise((function(e,r){var i,o,a,c,u;return function(t,n){return new Promise((function(e,r){var i;return i=Vn(n),R((function(){return Hn(i)}),(function(){return new Promise((function(e,r){var i;return Gn(n).then((function(n){try{return i=Dn(n),"string"==typeof t&&t.length>0&&(i=i.filter((function(n){return new RegExp(t,"gi").test(n.name)}))),e(i)}catch(t){return r(t)}}),r)}))})).then(e,r)}))}(n,t).then((function(n){try{return 1==(i=n).length&&(o=i[0].metadata,a=Zn(o.path,t),c=se(a),u=fe(o,c),i[0].metadata=u),e(i)}catch(t){return r(t)}}),r)}))})),ne("boardPinGet","local",(function(t,n,e){var r=ye(e,[]);return new Promise((function(e,i){var a,c,u;return a=r.version,function(t,n){return new Promise((function(e,r){return Yn(t,n).then((function(t){try{return e(t.path)}catch(t){return r(t)}}),r)}))}(n,t).then((function(r){try{return c=r,o(a)||((u=se(Zn(c,t))).versions.includes(a)||(a=ve(u.versions,a)),c=O(n,a)),e(Zn(c,t))}catch(t){return i(t)}}),i)}))})),ne("boardPinRemove","local",(function(t,n){return new Promise((function(e,r){return function(t,n,e){return void 0===e&&(e=!0),new Promise((function(r,i){var o,a,c;return Gn(n).then((function(u){try{return t=Bn(t,o=u),(a=o.filter((function(n){return n.name===t}))).length>0?(a=a[0],o=o.filter((function(n){return n.name!==t})),c=Zn(a.path,n),e&&w.remove(c,{recursive:!0}),qn(o,n).then(r,i)):r()}catch(t){return i(t)}}),i)}))}(n,t).then(e,r)}))})),ne("boardPinVersions","local",(function(t,n){return me(t,n)})),ne("boardInitialize","datatxt",He),ne("boardPinCreate","datatxt",Je),ne("boardPinFind","datatxt",Ze),ne("boardPinGet","datatxt",Ke),ne("boardPinRemove","datatxt",Qe),ne("boardPinVersions","datatxt",Xe),ne("boardInitialize","s3",nr),ne("boardPinCreate","s3",Je),ne("boardPinFind","s3",Ze),ne("boardPinGet","s3",Ke),ne("boardPinRemove","s3",Qe),ne("boardPinVersions","s3",Xe),ne("boardInitialize","azure",ir),ne("boardInitialize","gcloud",ur),ne("boardInitialize","dospaces",lr),ne("boardInitialize","rsconnect",(function(t,n){return new Promise((function(e,i){var o,a,c;if(a=(o=r.get("env"))("CONNECT_API_KEY")||o("RSCONNECT_API"),!n.key&&a&&(n.key=a),c=o("CONNECT_SERVER")||o("RSCONNECT_SERVER"),!n.server&&c&&(n.server=c),n.server&&(t.server=n.server.replace("/$",""),t.serverName=n.server.replace("https?://|(:[0-9]+)?/.*","")),t.account=n.account,t.outputFiles=n.outputFiles,!n.key)return i(new Error("Invalid API key, the API key is empty."));if(t.key=n.key,t.key&&!t.server)return i(new Error("Please specify the 'server' parameter when using API keys."));hr(t)||t.outputFiles||(t=dr(t));var u=function(){try{var n;if(!t.account)return pr(t,"/__api__/users/current/").then(function(e){try{return n=e.username,t.account=n,r.call(this)}catch(t){return i(t)}}.bind(this),i);function r(){return e(t)}return r.call(this)}catch(t){return i(t)}},s=function(n){try{return t.pinsSupported=!1,u()}catch(t){return i(t)}};try{return mr(t).then((function(n){try{return t.pinsSupported=n,u()}catch(t){return s()}}),s)}catch(t){s()}}))})),t.azureHeaders=rr,t.boardConnect=je,t.boardDeregister=function(t,n){if(void 0===n&&(n={}),!d().includes(t))throw"Board '"+t+"' is not registered";Ie(t);return n.disconnect&&Pe(t),function(t){delete h[t]}(t),null},t.boardDisconnect=Pe,t.boardGet=Ie,t.boardInitializeAzure=ir,t.boardInitializeDospaces=lr,t.boardInitializeGCloud=ur,t.boardInitializeS3=nr,t.boardList=Se,t.boardRegister=Fe,t.callbacks=r,t.dospacesHeaders=sr,t.gcloudHeaders=cr,t.pin=function(t){for(var n=[],e=arguments.length-1;e-- >0;)n[e]=arguments[e+1];return new Promise((function(e,r){return M("pin",Object.assign.apply(Object,[{x:t}].concat(n))),ee.apply(void 0,["pin",t].concat(n)).then((function(t){try{return e(l(t))}catch(t){return r(t)}}),r)}))},t.pinFetch=ue,t.pinFind=ae,t.pinGet=oe,t.pinInfo=function(t,n){n.board;var e=n.extended,r=n.metadata,i=n.signature;ie(n,["board","extended","metadata","signature"]);return new Promise((function(n,o){var a,c,u,s;return function(t,n,e,r){return new Promise((function(i,o){var a;return ae(null,{name:t,board:n,metadata:!1,extended:!1}).then((function(c){try{return 0==(a=c).length?o(new Error("Pin '"+t+"' was not found.")):a.length>1?o(new Error("Pin '"+t+"' was found in multiple boards: "+a.board.join(",")+".")):(n=a[0].board,ae(null,{name:t,board:n,metadata:r,extended:e}).then((function(t){try{return i((a=t)[0])}catch(t){return o(t)}}),o))}catch(t){return o(t)}}),o)}))}(t,c,e,r).then(function(e){try{if(c=(a=e).board,r=[],Object.keys(a).includes("metadata")&&a.metadata.columns.length>0&&(r=a.metadata),i)return oe(t,{board:c,files:!0}).then(function(t){try{return u=t,a.signature=pinVersionSignature(u),l.call(this)}catch(t){return o(t)}}.bind(this),o);function l(){for(t in delete(s=Object.assign(a)).metadata,[].concat(Object.keys(s)).forEach((function(t){!(s[t]instanceof Array)||1!=s[t].length||!(s[t][0]instanceof Array)||s[t][0].length>0||delete s[t]})),r)s[t]=r[t];return n(Object.assign(s,{class:"pin_info"}))}return l.call(this)}catch(t){return o(t)}}.bind(this),o)}))},t.pinLoad=ce,t.pinPreview=function(t){for(var n=[],e=arguments.length-1;e-- >0;)n[e]=arguments[e+1];return re.apply(void 0,["pinPreview",t].concat(n))},t.pinRemove=function(t,n){return new Promise((function(e,r){return n=Ie(n),Ae(n,t).then((function(t){try{return p(n),e(null)}catch(t){return r(t)}}),r)}))},t.pinVersions=function(t,n){var e=n.board,r=n.full;void 0===r&&(r=!1);ie(n,["board","full"]);var i=Oe(Ie(e),t);return r||(i.version=ge(i.version)),i},t.s3Headers=tr,t}({});
//# sourceMappingURL=pins.min.js.map
